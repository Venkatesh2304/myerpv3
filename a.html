<link rel="shortcut icon" href="/rsunify/resources/imgs/favico.png" />
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/themes/default/easyui.css?v=R26.1.0_20260129023001">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/themes/icon.css?v=R26.1.0_20260129023001">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/index.css?v=R26.1.0_20260129023001">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/customStyle.css?v=R26.1.0_20260129023001">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/easyui/productMaintainceCategory.css?v=R26.1.0_20260129023001">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/Index.css?v=R26.1.0_20260129023001">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/app-styles.css?v=R26.1.0_20260129023001">
<link rel="stylesheet" type="text/css" 
	href="/rsunify/resources/transactions/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" 
	href="/rsunify/resources/transactions/css/notifier.css?v=R26.1.0_20260129023001">	
<style type="text/css">
	
	

	#databse-info-div {
       position: fixed;
	   bottom: 0;
	   width: 100%;
	   background: #edeff1;
	   height: 20px;
	   text-align: center;
	   color: #000;
	   font-family: sans-serif;
	   font-weight: bold;
	   text-shadow: 0 1px 0 #84BAFF;
	   box-shadow: 0 0 13px #00214B;
	   text-transform: uppercase;
    }
    #databse-info-div div {
       	font-size: 13px !important;
       	font-family: sans-serif;
       	padding-right: 20px;
       	text-align: right;
      	    padding-top: 4px;
    }
    .chat-img{
    	float: right;
    	cursor: pointer !important;
    	margin-right: 2px;
    }
    
    /* push notification styles */

	div.ikea-push-notifier-bar {
		right: 0px;
		bottom: 0px;
		width: 380px;
		padding: 12px;
		position: fixed;	
		background: #fff;
		z-index: 9999999999;
		border: solid 5px #ddd;	
		box-shadow: 2px 2px 3px #ccc;
	}
	
	div.ikea-push-notifier-bar a.ikea-push-notify-close-btn {
		top: 0px;
		right: 0px;
		color: #bbb;
		padding: 10px;
		line-height: 10px;
		position: absolute;
	}
	
	div.ikea-push-notifier-bar a.ikea-push-notify-close-btn:hover {
		color: #777;
		background: #f0f0f0;
	}
	
	div.ikea-push-notifier-bar table {
		width: 100%;
		border-spacing: 0px;
		border-collapse: collapse;
	}
	
	div.ikea-push-notifier-bar table td {
		padding: 0px;
		vertical-align: top;
	}
	
	div.ikea-push-notifier-bar table td:first-child {
		width: 65px;
	}
	
	div.ikea-push-notifier-bar table td:last-child {
		padding: 0px 15px;
	}
	
	div.ikea-push-notifier-bar table td img {
		width: 100%;	
		margin-top: 8px;
	}
	
	div.ikea-push-notifier-bar table td p {
		color: #555;
		font-size: 13px;
		line-height: 18px;
		word-break: break-all;
		overflow-wrap: break-word;
		margin: 10px 0px 15px 0px;
		padding-bottom: 15px;
		word-break: break-word;
		border-bottom: solid 1px #ccc;
	}
	
	div.ikea-push-notifier-bar table td p:last-child {
		padding-bottom: 0px;
		border-bottom: none;
	}
	
	#ikea_tso_portal_home_box{
	    animation-name: floating;
    animation-duration: 2s;
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out;
    position: fixed;
    cursor: pointer !important;
    height: 88px;
    width: 101px;
    top: 6%;
    right: 1%;
    z-index: 2020;
}

#ikea_tso_portal_home_box .tso_prtl_hm_icn{
	background: #c9c97a;
    border-radius: 53%;
    width: 66px;
    margin-left: 15px;
}

#ikea_tso_portal_home_box .tso_prtl_hm_icn i{
	font-size: 62px;
    padding-left: 2px;
}

#ikea_tso_portal_home_box .tso_prtl_hm_txt{
	/*padding-left: 2px; */
    background: #858511;
    font-size: 15px;
    border-radius: 5%;
    color: white;
    font-weight: bold;
    text-align: center;
    width: 59px;
    margin-left: 17px;
}

</style>
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/jquery.datepicker.css?v=R26.1.0_20260129023001">
<link href="/rsunify/resources/CSS/ui.tree-view.css?v=R26.1.0_20260129023001"
	rel="stylesheet" type="text/css" id="skinSheet">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/reportapi/theme1.css?v=R26.1.0_20260129023001">
<link rel="stylesheet" type="text/css"
	href="/rsunify/resources/CSS/jquery-ui-1.10.4.custom.min.css?v=R26.1.0_20260129023001">
<script type="text/javascript"
	src="/rsunify/resources/js/jquery-3.7.1.min.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript" src="/rsunify/resources/js/jquery-ui.min.js?v=R26.1.0_20260129023001"></script>
		
<script type="text/javascript"
	src="/rsunify/resources/easyui/jquery.easyui.min.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/easyui/datagrid-cellediting.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/easyui/datagrid-filter.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/moment.min.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/custom-ui.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.datebox.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/keynavigator.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/vscontext.jquery.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/reportapi/appJsFile.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/date.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.datepicker.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/tableHeadFixer.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/tablenav.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.hotkeys.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.floatThead.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/jquery.blockUI.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
	src="/rsunify/resources/js/maintab.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript"
		src="/rsunify/resources/js/cookiesUtils.js?v=R26.1.0_20260129023001"></script>
		<script
	src="/rsunify/resources/transactions/js/utils/rsu-date-behaviour.js?v=R26.1.0_20260129023001"
	type="text/javascript"></script>
	
<script type="text/javascript" src="/rsunify/resources/js/inputmask.js?v=R26.1.0_20260129023001"></script>	 
<script type="text/javascript" src="/rsunify/resources/js/inputmask.date.extensions.js?v=R26.1.0_20260129023001"></script>	
<script type="text/javascript" src="/rsunify/resources/js/jquery.inputmask.js?v=R26.1.0_20260129023001"></script>
<link rel="stylesheet" type="text/css" href="/rsunify/resources/CSS/chatbot-css.css?v=R26.1.0_20260129023001">
<script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js?v=R26.1.0_20260129023001"></script>

<script type="text/javascript" src="/rsunify/resources/transactions/js/utils/rsu-app-alert.js?v=R26.1.0_20260129023001"></script> 
<script type="text/javascript" src="/rsunify/resources/transactions/js/libs/moment.js"></script>
<script type="text/javascript" src="/rsunify/resources/transactions/js/utils/ikea-notifier.js?v=R26.1.0_20260129023001"></script>

		
<script type="text/javascript">
var docker_path = "/rsunify";

var tsoCentralPortalUrl = "https://leveredgecentral.hulcd.com/TSOCentral/";
var newLogin_rsCode = "41A392";
var newLogin_userId = "27";
var isTsiUser = "false";
var loginUserName = "IIT";

function setAjaxHeaderCommon(xhr){
	xhr.setRequestHeader("user_key",getUserKey());
}

function getUserKey(){
	return newLogin_rsCode+"_"+newLogin_userId;
	//"user_key"
}

function allowMultiLogin(){
	return isTsiUser == "true" && tsoCentralPortalUrl != "";
}

var mocBakcupFlag = "";
var isForceClose = 0;
var import_flg_running = false;
var excludedScreensNames = ["Backup Database", "Beat Export", "Month Operating Cycle (MOC) - Closing and E-claim submission"];
//Check if window opened directly redirect to Error screen
if(window != undefined && window.name != undefined && $.trim(window.name) != ""){
	addScreeNameInLocalStorage(window.name);
} else {
	//showBrowserErrorMessage("User can't access the screen. Close it manually..");
	redirectUserToErrorPage("/rsunify/views/errorPages/ikeaError.jsp");
}

var localTimer;
var contentPublisher = null;
var impInterval;
var window_doc_path = null;
$(document).ready(function(){
	$(document).on('focus', ':input', function() {
		if( window.name == "Party Request Propasal Submission" ){
			$(this).attr('autocomplete', 'new-password' + Math.random().toString().replace( ".", "" ) );
		} else {
			$(this).attr('autocomplete', 'off');
		}
	});

	$( document ).on( "click", ".help:visible", function(){
		var context = $( this ).attr( "data-context" )
		if( window_doc_path != null ){
			window_doc_path.close();
		}
		if( context != "" && context != undefined ){			
			window_doc_path = window.open( '/rsunify/views/doc/index.jsp?path_directory='+context, '_blank' );
		} else {
			window_doc_path = window.open( '/rsunify/views/doc/index.jsp', '_blank' );
		}
	});
	
	$( window ).on( "keydown keyup", function(e){
		if( e.keyCode == 112 ){
			e.preventDefault();
			$( ".help" ).click();
		}
	});
	
	
	$( ".dateMaskFilter" ).attr( "data-behaviour", "date" );
	$( ".dateMaskFilter" ).removeClass( "dateMaskFilter" );
	writeLogMessageToServer("common-js-css.jsp ready(): " + document.cookie);
	if(window != undefined && window.name != undefined && $.trim(window.name) != ""){
		updateScreenNameIntoSession(window.name, 0);
	}
	$('div.txt-sms-display').drags();
	var inputContextID = $("#contextID").val();
	if(inputContextID !== "1770240034504"){
		//alert("Context IDs are Not matching Please Close Tab");
	}
	//console.log("Application Context ID: " + inputContextID + " --- 1770240034504");
	//window close event handle
	$(window).on("unload", function(){
		//window.opener.updateScreenStatus(window.name, 0);
		writeLogMessageToServer("common-js-css: unload - " + document.cookie);
		if(window.opener != null && window.opener.updateScreenStatus && typeof(window.opener.updateScreenStatus) === "function") {
            window.opener.updateScreenStatus(window.name, 0);
	    } else {
			removeScreenNameFromSession(window.name, 0);
	    }
	});
	//if user click outside when confirmation box exists changes - Rajesh
	var lastConfFocusButton = "";
	$(document).on("click contextmenu", function(){
		if($(".messager-window").is(":visible")){
			if(lastConfFocusButton === "")
				lastConfFocusButton = $(".messager-window").find(".l-btn:first")
			lastConfFocusButton.focus();
		}
	});
	$(document).on("mousedown", function(){
		if($(".messager-window").is(":visible")){
			lastConfFocusButton = $(":focus");
		}
	});
	var randomNumber = Math.floor((Math.random() * 9) * 100);
	localTimer = setInterval(checkLocalStorage, (2000+randomNumber));
	$.ajaxSetup({
        global: true,
        beforeSend: function (jqXHR, settings) {
            if(import_flg_running && settings['url'].indexOf("checkImportProc") == -1){
            	showDiaplyAlertMessages("Import Data Process Running not allowed to do any transaction!..", "error");
            	jqXHR.abort();
            	return false;
            }
        }
    });
	
	var tso_portal_home_url="";
	 function getTsoCentralDomainUrl(){
     	var domainUrl = "";
     	 $.ajax({
         	 method: "GET",
         	 async: false,
         	 url: "/rsunify/app/user/getDomainUrlfromCentralApi",
         	 // dataType: "json",
         	 beforeSend : function(xhr) {
        	if(allowMultiLogin())
				setAjaxHeaderCommon(xhr);			
		},
         	 success: function(data) {
         	 	if (data != undefined && $.trim(data.length) != 0) {
         	 		tso_portal_home_url = data;
         	 	}else{
         	 		$("#ikea_tso_portal_home_box").remove();
         	 	}
         	 },
         	 error: function(e) {
         		$("#ikea_tso_portal_home_box").remove();
         		//alert(e);
         	 }
         });
     }
	
	$("#ikea_tso_portal_home_box").on("click",function(){
		if( $(this).hasClass("noclick") ){
			$(this).removeClass("noclick");
			return;
		}
		if( window.opener != null && window.opener.opener != null && !window.opener.opener.closed ){
			 dlgMain = $.messager.confirm({
				 title: 'LeverEDGE', 
				 msg: "LeverEDGE Central is Already open, Please use opened window",
				 width: "650px",
				 buttons:[{
			        text: 'OK',
			        onClick: function(){
			           dlgMain.dialog('destroy');
			           //return false;
			        }
			    }],
			    onDestroy:function(){
			    	//return false;
			    }
			 });
		}else{
			let w = window.open(tso_portal_home_url+"home","tso_central");
		}
	});
	
	
	
	//impInterval = setTimeout(checkImportProcStatus, (60*1000));
	getRsInformationReportsFooter();
	getTsoCentralDomainUrl();
	
	/**Notifier initialization */
	contentPublisher = new ikea_notifier();
	contentPublisher.init(window.name);
	//console.log(window.name);
	//contentPublisher.prepareModuleNotifications(window.name);
	
	
	
});
function checkImportProcStatus(){
	$.ajax({
  		method : "POST",
  		url : "/rsunify/app/ikeaCommonUtilController/checkImportProc",
  		cache: false,
  		beforeSend : function(xhr) {
        	if(allowMultiLogin())
				setAjaxHeaderCommon(xhr);			
		},
  		success : function(jsonResponse) {
  			if(jsonResponse != undefined && jsonResponse['status'] != undefined){
  				import_flg_running = jsonResponse['status'];
  			}
  			clearTimeout(impInterval);
  			impInterval = setTimeout(checkImportProcStatus, (60*1000));
  		}, error : function(){
  			clearTimeout(impInterval);
  			impInterval = setTimeout(checkImportProcStatus, (60*1000));
  		}
  	});
}
$(document).ajaxError(function(event, jqxhr, settings, thrownError) {
	//console.log("Triggered ajaxError handler." + jqxhr.status);
	if(jqxhr.status === 750){
		isForceClose = 1;
		if(window.opener == undefined || window.opener == null || (window.opener == window)){
			redirectUserToErrorPage("/rsunify/views/errorPages/ikeaSessionExpired.jsp");
		} else {
			if(window.opener.redirectToLogin && typeof(window.opener.redirectToLogin) === "function") {
				window.opener.redirectToLogin();
				window.close();
			} else {
				redirectUserToErrorPage("/rsunify/views/errorPages/ikeaSessionExpired.jsp");
			}
		}
	} else if(jqxhr.status === 752){
		showDiaplyAlertMessages(jqxhr.getResponseHeader("error"), "error");
	}
	 //window.location.href = "./login.jsp";
});

function dateMaskFilter(){
	//Common Validation for all the date related inputs. 
             $(".dateMaskFilter").inputmask("dd/mm/yyyy",{
                     "onincomplete": function(){
                           var day, month, year, unfilledDay, unfilledMonth, unfilledYear, newDay = null,
                           newMonth = null, newYear = null, newDate, charYear;
                           
                           day = $(this).val().substring(0, 2);
                           month = $(this).val().substring(3, 5);
                           year = $(this).val().substring(6, 10);
                           
                           todayDate = new Date();
                           
                           //handle day
                           unfilledDay = (day.match(new RegExp("d", "g")) || []).length
                           if(unfilledDay === 0){
                                  newDay = day;
                           }else if(unfilledDay === 1 && day.charAt(0) == "d"){
                                  newDay = "0" + day.charAt(1);
                           }else if(unfilledDay === 1 && day.charAt(1) == "d"){
                                  newDay = "0" + day.charAt(0);
                           }
                          
                           //handle month
                           unfilledMonth = (month.match(new RegExp("m", "g")) || []).length
                           if(unfilledMonth === 0){
                                  newMonth = month;
                           }else if(unfilledMonth === 1 && month.charAt(0) == "m"){
                                  newMonth = "0" + month.charAt(1);
                           }else if(unfilledMonth === 1 && month.charAt(1) == "m"){
                                  newMonth = "0" + month.charAt(0);
                           }
                           
                           //handle year
                           unfilledYear = (year.match(new RegExp("y", "g")) || []).length
                           console.log(unfilledYear);
                           if(unfilledYear === 0){
                                  newYear = year;
                           }else if(unfilledYear === 1){
                        	    var first2Chars = year.substring(0, 2);
                                charYear = year.substring(2, 3);
                        	    if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                        	    	newYear = first2Chars + "0" + charYear;
                        	    }
                           }else if(unfilledYear === 2){
                                  charYear = year.substring(0, 2);
                                  if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                                         newYear = "20" + charYear;
                                  }
                           }else if(unfilledYear === 3){
                                  charYear = year.substring(0, 1);
                                  if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                                         newYear = "200" + charYear;
                                  }
                           }else if(unfilledYear === 4){
                                  newYear = todayDate.getFullYear();
                           }
                           
                        //After day, month and year calculations..
                        if( newDay == null || newMonth == null || newYear == null ){
                               $(this).focus();
                               $('#display-message').text('Please enter valid date').addClass('txt-black');
                        }else{ 
                               if(newDay === "00"){ newDay = todayDate.getDate();}
                               if(newMonth === "00"){ newMonth = todayDate.getMonth() + 1;}
                               newDate = newDay + "/" + newMonth + "/" + newYear;
                               $(this).val(newDate);
                        }                       
                     },
                     "oncomplete": function(){    
                    	 //do something on completing... 
                     }
              });
	
                   /*                 $(".date-pick").inputmask("dd/mm/yyyy",{ 
                        "onincomplete": function(){ 
								$(this).focus();
                                $('#display-message').text("Value is not valid date.").removeClass('txt-black').addClass('txt-red'); 
                        },
                        "oncomplete": function(){ 
                                $('#display-message').text("").removeClass('txt-red').addClass('txt-black');
                        }
	            }); */
}

$(document).ready(function(){
$(".dateMaskFilter").focusout(function(){
	var checkLeap = $(this).val().split('/');
	//console.log(checkLeap[2]);
	validateBeforeInputMask($(this));
	if((checkLeap[2] % 4 == 0) && (checkLeap[2] % 100 != 0) || (checkLeap[2] % 400 == 0)){
	  if(checkLeap[1] == 2 && checkLeap[0] > 29){
		  $(this).val('29/02/'+checkLeap[2])		  
	  }
    }else{
    	if(checkLeap[1] == 2 && checkLeap[0] > 28){
  		  $(this).val('28/02/'+checkLeap[2])		  
  	  }
    }

	
	if(checkLeap[1] == 4 && checkLeap[0] > 30){
		  $(this).val('30/04/'+checkLeap[2])		  
	  }
	if(checkLeap[1] == 6 && checkLeap[0] > 30){
		  $(this).val('30/06/'+checkLeap[2])		  
	  }
	if(checkLeap[1] == 9 && checkLeap[0] > 30){
		  $(this).val('30/09/'+checkLeap[2])		  
	  }
	if(checkLeap[1] == 11 && checkLeap[0] > 30){
		  $(this).val('30/11/'+checkLeap[2])		  
	  }
});

$(".dateMaskFilter").keydown(function(e){
	if(e.ctrlKey && e.keyCode==67){document.execCommand('copy');}
	else if(e.shiftKey && e.keyCode==9 && ($(this).val()=="")){}
	else if(e.keyCode==9 && ($(this).val()=="")){
		$(this).siblings('a').focus();
		 $(this).val('');
		 return false;
	}
		});
		
var clickflag = false;	
var downPos
$('#boticon').mousedown(function(e){
	clickflag = false;
	downPos = $(this).position();
});
$('#boticon').mouseup(function(e){
	
	var upPos = $(this).position();
	if( Math.abs( downPos.top - upPos.top ) < 2 && Math.abs( downPos.left - upPos.left ) < 2){
		clickflag = true;
	}
});
$('#boticon').draggable({
	containment: "window",
});
$('#boticon').click(function(event) {
   		if(clickflag){
   			myFunction();
   		}
});

$('#ikea_tso_portal_home_box').draggable({
	//	scroll: false, 
		containment: "window",
	    start: function(event, ui) {
	        $(this).addClass('noclick');
	    }
});

});
function validateBeforeInputMask(dateObj){
    //console.log("onincomplete event..");
	var day, month, year, unfilledDay, unfilledMonth, unfilledYear, newDay = null,
    newMonth = null, newYear = null, newDate, charYear;
    
    day = dateObj.val().substring(0, 2);
    month = dateObj.val().substring(3, 5);
    year = dateObj.val().substring(6, 10);
    
    todayDate = new Date();
    
    //handle day
    unfilledDay = (day.match(new RegExp("d", "g")) || []).length
    if(unfilledDay === 0){
           newDay = day;
    }else if(unfilledDay === 1 && day.charAt(0) == "d"){
           newDay = "0" + day.charAt(1);
    }else if(unfilledDay === 1 && day.charAt(1) == "d"){
           newDay = "0" + day.charAt(0);
    }
   
    //handle month
    unfilledMonth = (month.match(new RegExp("m", "g")) || []).length
    if(unfilledMonth === 0){
           newMonth = month;
    }else if(unfilledMonth === 1 && month.charAt(0) == "m"){
           newMonth = "0" + month.charAt(1);
    }else if(unfilledMonth === 1 && month.charAt(1) == "m"){
           newMonth = "0" + month.charAt(0);
    }
    
    //handle year
    unfilledYear = (year.match(new RegExp("y", "g")) || []).length
    //console.log(unfilledYear);
    if(unfilledYear === 0){
           newYear = year;
    }else if(unfilledYear === 1){
 	    var first2Chars = year.substring(0, 2);
                            charYear = year.substring(2, 3);
 	    if((charYear.match(new RegExp("y", "g")) || []).length === 0){
 	    	newYear = first2Chars + "0" + charYear;
 	    }
    }else if(unfilledYear === 2){
           charYear = year.substring(0, 2);
           if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                  newYear = "20" + charYear;
           }
    }else if(unfilledYear === 3){
           charYear = year.substring(0, 1);
           if((charYear.match(new RegExp("y", "g")) || []).length === 0){
                  newYear = "200" + charYear;
           }
    }else if(unfilledYear === 4){
           newYear = todayDate.getFullYear();
    }
    newDate = newDay + "/" + newMonth + "/" + newYear;
  	//After day, month and year calculations..
    if( newDay == null || newMonth == null || newYear == null ){
    	dateObj.focus();
        $('#display-message').text('Please enter valid date').addClass('txt-black');
    } else {
	    dateObj.val(newDate);
    }
}
function removeScreenNameFromSession(screenName, multiUserCheck){
	var jsonData = {};
		if(allowMultiLogin()){
			screenName = removeUniqueKeyFromScreenName(screenName);
		}
        jsonData.screenName = screenName;
        $.ajax({
		     type: "POST",
		     url: "/rsunify/app/ikeaCommonUtilController/removeScreenNameFromSession",
		     async: false,
		     data: {"strJsonParams":encodeURIComponent(JSON.stringify(jsonData))},
	         dataType: "JSON",
	         beforeSend : function(xhr) {
	         	if(allowMultiLogin())
	 				setAjaxHeaderCommon(xhr);			
	 		},
	         success: function (jsonResponse) {
	   		        //serverResp = jsonResponse;
		        console.log(jsonResponse);
		     },
		     error: function (jsonResponse) {
			  //do nothing
			 console.log(jsonResponse);
		     }
	    });
}

function removeUniqueKeyFromScreenName(screenName){
	return screenName.replace(getUserKey(),"");
}

function updateScreenNameIntoSession(screenName, isTrackUpdate){
	var jsonData = {};
	if(allowMultiLogin()){
		screenName = removeUniqueKeyFromScreenName(screenName);
	}
	jsonData.screenName = screenName;
	jsonData.pbayoutUpdate = ""+isTrackUpdate;
	jsonData.mainTabFlag = "0";
	$.ajax({
		type: "POST",
		url: "/rsunify/app/ikeaCommonUtilController/updateScreenNameIntoSession",
		data: {"strJsonParams":encodeURIComponent(JSON.stringify(jsonData))},
    	dataType: "JSON",
		async: false,
		beforeSend : function(xhr) {
        	if(allowMultiLogin())
				setAjaxHeaderCommon(xhr);			
		},
    	success: function (jsonResponse) {
    		//validateRepsonseAndContinue(jsonResponse, loadPageURL, screenName);
		},
		error: function (jsonResponse) {
			//do nothing
		}
   	});
}
function addScreeNameInLocalStorage(screenName){
	writeLogMessageToServer("common-js-css: addScreeNameInLocalStorage - " + document.cookie);
	var sessionArray = {};
	var  tabsOpened = readCookie("tabsOpened");
	if(tabsOpened == undefined || tabsOpened == "" || $.isEmptyObject(JSON.parse(tabsOpened))){
		//sessionArray = {"date":new Date(), "openedTabs":[]};
	} else {
		sessionArray = JSON.parse(tabsOpened);
		if($.inArray(screenName, sessionArray['openedTabs']) == -1){
			sessionArray['openedTabs'].push(screenName);
		}
		setCookie("tabsOpened", JSON.stringify(sessionArray));
	}
}
function checkLocalStorage(){
	if( !allowMultiLogin() ){
		writeLogMessageToServer("common-js-css: checkLocalStorage - " + document.cookie);
		var  tabsOpened = readCookie("tabsOpened");
		if(tabsOpened != undefined && tabsOpened != ""){
			var sessionArray = JSON.parse(tabsOpened);
			if($.inArray(window.name, sessionArray['openedTabs']) == -1){
				redirectUserToErrorPage("/rsunify/views/errorPages/ikeaSessionExpired.jsp");
			}
		} else 
			redirectUserToErrorPage("/rsunify/views/errorPages/ikeaSessionExpired.jsp");

	}
}
function redirectUserToErrorPage(pageURL){
	/*If any moc, backup or qtm export is running don't invalidate*/
	writeLogMessageToServer("common-js-css: redirect- " + document.cookie);
	if(!validateBeforeCloseorRedirect()){
		addScreeNameInLocalStorage(window.name);
		return false;
	} else {
		clearInterval(localTimer);
		window.name = "";
		window.onunload = "";
		window.onbeforeunload = "";
		$(window).off("beforeunload");
		$(window).off("unload");
		var windowURL = window.location.href;
		//exlcude active screens info
		if(windowURL.indexOf("views/utilities/ikeaActiveScreen.jsp") == -1){
			try{window.close();}catch (e){}
			if(window.closed == false){
				window.location.href = pageURL;
			}
		}
	}
}
/*If any moc, backup or qtm export is running don't invalidate*/
function validateBeforeCloseorRedirect(){
	var result = true;
	if(isForceClose == 0){
		if($.inArray(window.name, excludedScreensNames) != -1){
			if(!checkBackupOrMocRunning()){
				result = false;
			}
		}
	}
	return result;
}
function checkBackupOrMocRunning(){
	var isContinue = true;
	$.ajax({
  		method : "POST",
  		url : "/rsunify/app/ikeaCommonUtilController/validateMocOrBackupRunning",
  		async: false,
  		cache: false,
  		data: "",
  		beforeSend : function(xhr) {
        	if(allowMultiLogin())
				setAjaxHeaderCommon(xhr);			
		},
  		success : function(jsonResponse) {
  			mocBakcupFlag = jsonResponse; 
  			if(jsonResponse == undefined || $.trim(jsonResponse) == "" || jsonResponse == "NOT_RUNNING"){
  				isContinue = true;
  			} else {
  				//setCookie("maitabOpened", "Yes");
				//setCookie("tabsOpened", JSON.stringify({"date":new Date(),"openedTabs":["Login",jsonResponse]}));
  				isContinue = false;
  			}
  			if(isContinue)
  			{
  				var mocProcessStatus = readCookie("mocProcesStatus");
  				var lastUpdatedTime = -1;
  				//check last update time
  				if(mocProcessStatus === "Completed"){
  					lastUpdatedTime = Number(readCookie("processLastUpdatedTime"));
  					lastUpdatedTime = isNaN(lastUpdatedTime) ? 0 : lastUpdatedTime;
  					lastUpdatedTime = formatCurrentDateToMillis() - lastUpdatedTime;
  					lastUpdatedTime = isNaN(lastUpdatedTime) ? 0 : lastUpdatedTime;
  				}
  				if(mocProcessStatus === "InProgress" || (lastUpdatedTime > 0 && lastUpdatedTime <= (5*60*1000))){
  					isContinue = false;
  				}
  			}
  		}, error : function(){
  			isContinue = true;
  		}
  	});
	return isContinue;
}
function vsContextMenuKeyEvent( keyName ) {
	var returns = false;
		$( ".vs-context-menu ul li" ).each( function() {
			var liTag = this;
			if( !( $( liTag ).attr( "disabled" ) === "disabled" ||  $( liTag ).attr( "disabled" ) == "true" ) ) {
				var aEnable = $( liTag ).find( "a" );
				if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
					if( $( aEnable ).text().toUpperCase().indexOf( keyName.toUpperCase() ) != -1 ) {
						$( aEnable ).trigger( "click" );
						returns = true;
						return false;
					}
				}
			}
		});
	return returns;
}

function findActiveVsContextMenu( container, currentLiIdx, mode ) {
		var i=currentLiIdx,totalCount = $( container ).find( "ul li" ).length;
		if( mode == "NEXT" ) {
			i++;
			for( ; i < totalCount; i++ ) {
				var liTag = $( container ).find( "ul li:eq("+i+")" );
				if( !( $( liTag ).attr( "disabled" ) === "disabled" ||  $( liTag ).attr( "disabled" ) == "true" ) ) {
					var aEnable = $( liTag ).find( "a" );
					if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
						return aEnable;
					}
				}
			}
		} else {
			i--;
			for( ; i >= 0; i-- ) {
				var liTag = $( container ).find( "ul li:eq("+i+")" );
				if( !( $( liTag ).attr( "disabled" ) === "disabled" ||  $( liTag ).attr( "disabled" ) == "true" ) ) {
					var aEnable = $( liTag ).find( "a" );
					if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
						return aEnable;
					}
				}
			}
		}
		return "";
} 

function setFirstActiveVsContextMenu( container ) {
	$( container ).find( "ul li" ).each( function() {
		if( !( $( this ).attr( "disabled" ) === "disabled" ||  $( this ).attr( "disabled" ) == "true" ) )
			var aEnable = $( this ).find( "a" );
			if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
				aEnable.addClass( "vs-context-menu-a-active" );
				return false;
			}
	} );
	
}

function setLastActiveVsContextMenu( container ) {
	$( $( container ).find( "ul li" ).get().reverse() ).each( function() {
		if( !( $( this ).attr( "disabled" ) === "disabled" ||  $( this ).attr( "disabled" ) == "true" ) )
			var aEnable = $( this ).find( "a" );
			if( aEnable && aEnable.length > 0 && !( $( aEnable ).attr( "disabled" ) === "disabled" ||  $( aEnable ).attr( "disabled" ) == "true" ) ) {
				aEnable.addClass( "vs-context-menu-a-active" );
				return false;
			}
	} );
}

/* Code to prevent the right click */
$(document).on('contextmenu',function(e){
	 if(e.which=='3'){
		  e.preventDefault();
		} 
});
$(document).on('contextmenu', '.messager-window, #dp-popup', function(e){
	if(e.which=='3'){
	  e.preventDefault();
	}
});

var vscontext = {
		preFocus: ""	
	};

	$( document ).on( "vscontext-show", ".vs-context-menu",  function( e ){
		var that = this;
		$( this ).attr( "tabindex", -1 );
		setTimeout( function() {
			vscontext.preFocus = $( ":focus" );
			$( that ).focus();
			
			if( !$( that ).is( ":focus" ) ) {
				$( that ).hide();
				return false;
			}
			
			$( that )[0].onkeydown = function( e ) {
				 var theEvent = e || window.event;
			 	 var key = theEvent.keyCode || theEvent.which;
			 	 if( key == 13 ) {
			 		theEvent.preventDefault();
			 		theEvent.stopPropagation();
			 		 var activeA = $( that ).find( "ul li a.vs-context-menu-a-active" );
			 		if( activeA.length > 0 ) {	
			 			 activeA.removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
			 		 	setTimeout( function() {
			 				activeA.trigger( "click" );
			 		 	}, 100 );
			 		}
			 		return false;
			 	 } else if( key == 27) {
			 		$( that ).hide();
			 		$( that ).trigger( "vscontext-hide-focus" );
			 		theEvent.preventDefault();
			 		theEvent.stopPropagation();
			 		return false;
			 	 } else if( key == 40 ) {
			 		 var activeA = $( that ).find( "ul li a.vs-context-menu-a-active" );
			 		 if( activeA.length > 0 ) {
			 			 activeA.removeClass( "vs-context-menu-a-active" );
			 			 var parentLi = activeA.parent( "li" );
			 			 var nextA = findActiveVsContextMenu( that, parentLi.index(), "NEXT" );
			 			 if( nextA.length > 0) {
			 				nextA.addClass( "vs-context-menu-a-active" );
			 			 } else {
			 				setFirstActiveVsContextMenu( that );
			 			 }
			 		 } else {
			 			setFirstActiveVsContextMenu( that ); 
			 		 }
			 		theEvent.preventDefault();
			 		theEvent.stopPropagation();
			 		return false;
			 	 } else if( key == 38 ) {
			 		 var activeA = $( that ).find( "ul li a.vs-context-menu-a-active" );
			 		 if( activeA.length > 0 ) {
			 			 activeA.removeClass( "vs-context-menu-a-active" );
			 			 var parentLi = activeA.parent( "li" );
			 			 var prevA = findActiveVsContextMenu( that, parentLi.index(), "PREV" );
			 			 if( prevA.length > 0) {
			 				prevA.addClass( "vs-context-menu-a-active" );
			 			 } else {
			 				setLastActiveVsContextMenu( that );
			 			 }
			 		 } else {
			 				setLastActiveVsContextMenu( that );
			 		 }
			 		theEvent.preventDefault();
			 		theEvent.stopPropagation();
			 		return false;
			 	 } else if( key == 78 ) { 
			 		if( vsContextMenuKeyEvent( "NEW" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
			 			theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 79 ) { 
			 		if(	vsContextMenuKeyEvent( "OK" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 67 ) { 
			 		if(	vsContextMenuKeyEvent( "CLEAR" ) || vsContextMenuKeyEvent( "CLOSE" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 70 ) { 
			 		if(	vsContextMenuKeyEvent( "FIND" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 71 ) { 
			 		if(	vsContextMenuKeyEvent( "GENERATE" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
			 	 } else if( key == 83 ) { 
				 		if(	vsContextMenuKeyEvent( "SAVE" ) ) {
				 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
				 			$( that ).hide();
					 		theEvent.preventDefault();
					 		theEvent.stopPropagation();
					 		return false;
				 		}
				} else if( key == 69 ) {
			 		if(	vsContextMenuKeyEvent( "PREVIEW" ) ) {
			 			$( that ).find( "ul li a" ).removeClass( "vs-context-menu-a-active" );
			 			$( that ).hide();
				 		theEvent.preventDefault();
				 		theEvent.stopPropagation();
				 		return false;
			 		}
				 	 }
			};
		}, 10 );
	} );

	$( document ).on( "mouseenter", ".vs-context-menu ul li a", function(e) {
		$( ".vs-context-menu ul li a" ).removeClass( "vs-context-menu-a-active" );
		$( this ).addClass( "vs-context-menu-a-active" );
	} );


	$( document ).on( "vscontext-hide", ".vs-context-menu",  function( e ){
		$( ".vs-context-menu ul li a" ).removeClass( "vs-context-menu-a-active" );
		$( ".vs-context-menu" ).removeAttr( "tabindex" );
		$( ".vs-context-menu" )[0].onkeydown = null;
	} );

	$( document ).on( "vscontext-hide-focus", ".vs-context-menu",  function( e ){
		$( ".vs-context-menu ul li a" ).removeClass( "vs-context-menu-a-active" );
		$( ".vs-context-menu" ).removeAttr( "tabindex" );
		$( ".vs-context-menu" )[0].onkeydown = null;
		if( vscontext.preFocus.length > 0 ) {
				vscontext.preFocus.focus();
			}
	} );
	
	function writeLogMessageToServer(logMessage){
		if(window.opener != null && window.opener.writeConsoleToServerLog && typeof(window.opener.writeConsoleToServerLog) === "function") {
			window.opener.writeConsoleToServerLog(logMessage);
		}
	}
	
	function printReport(filePath, printerName,destroyCallback, yesCallback, noCallback){
		printReportFile("/rsunify",filePath, printerName, yesCallback, noCallback, destroyCallback);
	}
	
	function prepareAvailablePrinters(){
		return preparePrinterSelection("/rsunify");
	}
	
	function printPreview(filePath){
		previewReportNewTab("/rsunify", filePath);
		//downloadReportFileNewTab("/rsunify", filePath)

	}
	
	function previewExcelSheet(filePath){
		previewExcelReportNewTab("/rsunify", filePath);
	}
	
	function getRsInformationReportsFooter(){
	     var jsonObj = {"viewName" : "RS_INFORMATION"};
		 $.ajax({
		      method : "POST",
		      url : "/rsunify/app/reportsController/getReportScreenData?jasonParam="+encodeURIComponent(JSON.stringify(jsonObj)),
		      async: true,
		      dataType: "JSON",
		      beforeSend : function(xhr) {
		        	if(allowMultiLogin())
						setAjaxHeaderCommon(xhr);			
				},
		      success : function(data) {
		          $.each( data,function(key, card) {
		               if(card != undefined && card.length >= 2){
		                    //rsInfo.rsCode=(card[i][1]);
		                    //console.log("Agency Name is: " + card[1][2]);
		                    $("#distributor_name").text(card[1][1] + " - " + card[1][2] + " ("+card[1][9]+")" + " - User:"+loginUserName);
		                    //rsInfo.rsAgencies=(card[0][2]);
		                    //rsInfo.dimAddress1=(card[i][3]);
		                    //rsInfo.dimAddress2=(card[i][4]);
		                    //rsInfo.dimAddress3=(card[i][5]);
		                    //rsInfo.dimState=(card[i][6]);
				            //rsInfo.tinNumber=(card[i][7]);
				            //rsInfo.pinCode=(card[i][8]);
		               }
		          });
		      }
		 });
	}
	
	function showDiaplyAlertMessages(message, msgType){
	     $("#display-message").text(message);
	 if(msgType === "info"){
	      $('#display-message').addClass("txt-black");
	      //$(".txt-cont-are").css({"color":"maroon", "text-align":"left"});
	 } else {
	      $('#display-message').removeClass("txt-black");
	      //$(".txt-cont-are").css({"color":"red", "text-align":"right"});
	     }
	}
	/*chat bot script starts here*/
	
	if("false" == "true"){
		var chatClose = false;
		function myFunction() {	
			$("#rsu-logtodo-menu-item").trigger("click");
			 document.getElementById("botsection").style.display = "block";
			  document.getElementById('boticon').style.display = "none";
			  document.getElementById("overlayHelpline").style.display = "none";
			  document.getElementById("overlay").style.display = "none";
			  document.getElementById("callIcon").style.display = "block";
			  document.getElementById("callIconAfter").style.display = "none";
			  document.getElementById("homeIconCall").style.display = "none";
			  document.getElementById("homeIcon").style.display = "block";
			  //console.log('inside myFunction '+close);
			 
			  		  
			  if(chatClose){
				 //console.log('inside myFunctionif '+close);
				  //document.getElementById('botsection').append('div');
				  
		          $(".bot-delete").remove();
		          document.getElementById('botsection').innerHTML += '<div id="bot" class="bot-delete" style="display: none;"></div>';
				  
				  window.WebChat.renderWebChat(
		            {
		               directLine: window.WebChat.createDirectLine({
		                  token: 'hm97epYqYoc.yfedIx4nGVcT4aw-bmfmWWnk52vZjxtTlCNrxM9y2zw'
		               }),
					   
		            },
		            document.getElementById('bot')
		          );
				  chatClose = false;
				}
			 }
			 
			function minimizeChat() {
			  document.getElementById("botsection").style.display = "none";
			  document.getElementById('boticon').style.display = "block";
			  document.getElementById("overlay").style.display = "none";
			  document.getElementById("overlayHelpline").style.display = "none";
			}
			
			function helplineWIndow() {
			  document.getElementById("overlayHelpline").style.display = "block";
			  document.getElementById("overlay").style.display = "none";
			  document.getElementById("callIcon").style.display = "none";
			  document.getElementById("callIconAfter").style.display = "block";
			  document.getElementById("homeIcon").style.display = "none";
		   	  document.getElementById("homeIconCall").style.display = "block";
			}
			
			function closeChat() {
				document.getElementById("overlay").style.display = "block";
				document.getElementById("overlayHelpline").style.display = "none";
			}
			
			function refreshChat() {
			  document.getElementById("botsection").style.display = "block";
			  document.getElementById('boticon').style.display = "none";
			  document.getElementById("overlayHelpline").style.display = "none";
			  document.getElementById("overlay").style.display = "none";
			  document.getElementById("callIcon").style.display = "block";
			  document.getElementById("callIconAfter").style.display = "none";
			  document.getElementById("homeIconCall").style.display = "none";
			  document.getElementById("homeIcon").style.display = "block";
			  document.getElementById('botsection').innerHTML += '<div id="bot" class="bot-delete" style="display: none;"></div>';
			}
			
			function yes(){
				document.getElementById("botsection").style.display = "none";
			  	document.getElementById('boticon').style.display = "block";
			  	document.getElementById("overlay").style.display = "none";
			   //location.reload();
			   chatClose = true;
			}

			function no(){
				document.getElementById("overlay").style.display = "none";
				chatClose = false;
			}
			
		(async function() {
				window.WebChat.renderWebChat(
				{
	               directLine: window.WebChat.createDirectLine({
	                  token: 'hm97epYqYoc.yfedIx4nGVcT4aw-bmfmWWnk52vZjxtTlCNrxM9y2zw'
	               }),
	            },
	            document.getElementById('bot')
			);
			}
		)().catch(err => console.error(err));
	}
	/*chat bot script end here*/
</script>

<script type="text/javascript" >

	var ikea_push_notifier = new ikea_app_alert();
	ikea_push_notifier.init();
	
	$(window).on('storage', function(e) {
		
		if (e.originalEvent.key!='push_msg') return; // ignore other keys
		
		var payload=JSON.parse(e.originalEvent.newValue);
		if (!payload) return; // ignore empty msg or msg reset
	
		if (payload.command == 'notify') {
			ikea_push_notifier.notify(payload.msg);
		}
		
	});
	
	
	
	
	//scheduler alert
	
	var limenAlertTime = null;
	var limenAlertMessage = null;
	var limenAlertInterval = null;
	var mocMintusConfigVal = null;
	
	function setLimenAlertTimerData(limenAlertTimeLocal,limenAlertMessageLocal,mocMintusConfigValLocal){
		console.log("called");
		limenAlertTime = limenAlertTimeLocal;
		limenAlertMessage = limenAlertMessageLocal;
		mocMintusConfigVal = mocMintusConfigValLocal;
		clearInterval(limenAlertInterval);
		limenAlertInterval = setInterval(showLimenAlert,1000);
	}
	
	function showLimenAlert(){
		var msg = "";
	//	rSuControllerObj.ikeaServerTime = Number(rSuControllerObj.ikeaServerTime) + 1000;
		//var dt = new Date(rSuControllerObj.ikeaServerTime);
		var dt1 = new Date(limenAlertTime);
		
		var localDt = new Date();
		var localDt1 = new Date(limenAlertTime);
		//var range = 30*60*1000; // 30 minutes
		if(localDt.getTime()<dt1.getTime()){
			if(limenAlertMessage.includes('Moc Closure')){ // disableing Manual Moc closure before 10 mintus of Auto Moc Closure
				var blockingTime = dt1.getTime() - 1000 * 60*mocMintusConfigVal;
				if(localDt.getTime()>=blockingTime){
					$('#moccloseelaimgenerationscreen').attr("disabled", true).addClass('disabled'); 
				} 
			}
			var diffSeconds = 0;
			var diffMinutes = 0;
			//validating in server side
			//if(dt1.getTime()-dt.getTime() < range){
			var diffTimeinMillies = parseInt((dt1.getTime()-localDt.getTime())/1000);
			diffMinutes = parseInt(diffTimeinMillies/60);
			diffSeconds = parseInt(diffTimeinMillies % 60);
			msg = limenAlertMessage+"<br><h2 style='text-align:center;'>"+diffMinutes+"  mins "+diffSeconds+"  secs</h2>";
			//}
			if($('.ikea_alert_message_box').is(":visible")){
				$("#ikea_limen_alert_content").html(msg);
			}else{
				$("#ikea_limen_alert_content").html(msg);
				$( ".ikea_alert_message_box" ).slideDown(800);
			}
			
		}else{
			clearInterval(limenAlertInterval);
			$( ".ikea_alert_message_box" ).slideUp(800);
		}
		
		
		
	}
	
</script>

<div class="txt-sms-display">
 	<div class="txt-cont-are" id="display-message"></div>
</div>
<div class="ikea_alert_message_box">
	<div class="ikea_limen_alert_title">CU Sync Alert</div>
	<div class="ikea_limen_alert_content">
		<p id="ikea_limen_alert_content">
			LeverEDGE Limen Alert
		</p>
	</div>
</div>
<input type="hidden" id="contextID" value="1770240034504" />
<div id="databse-info-div">
	<div id="distributor_name">&nbsp;</div>
</div>
<!-- chat bot html starts here -->
<!-- chat bot html ends here --><script type="text/javascript" src="/rsunify/resources/js/common-ui.js?v=R26.1.0_20260129023001"></script>
<link rel="stylesheet" type="text/css" href="/rsunify/resources/CSS/jquery.datepicker.css?v=R26.1.0_20260129023001"> 
<script type="text/javascript" src="/rsunify/resources/js/jquery.datepicker.js?v=R26.1.0_20260129023001"></script>
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Beat Export</title>

<script type="text/javascript">(window.NREUM||(NREUM={})).init={privacy:{cookies_enabled:true},ajax:{deny_list:["bam.nr-data.net"]},feature_flags:["soft_nav"],distributed_tracing:{enabled:true}};(window.NREUM||(NREUM={})).loader_config={agentID:"1588758100",accountID:"1015347",trustKey:"93570",xpid:"VQYGVFVXDxABUVRWBQgCVlcH",licenseKey:"dcb54cd47d",applicationID:"1554295036",browserID:"1588758100"};;/*! For license information please see nr-loader-spa-1.308.0.min.js.LICENSE.txt */
(()=>{var e,t,r={384:(e,t,r)=>{"use strict";r.d(t,{NT:()=>a,US:()=>u,Zm:()=>o,bQ:()=>d,dV:()=>c,pV:()=>l});var n=r(6154),i=r(1863),s=r(1910);const a={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net"};function o(){return n.gm.NREUM||(n.gm.NREUM={}),void 0===n.gm.newrelic&&(n.gm.newrelic=n.gm.NREUM),n.gm.NREUM}function c(){let e=o();return e.o||(e.o={ST:n.gm.setTimeout,SI:n.gm.setImmediate||n.gm.setInterval,CT:n.gm.clearTimeout,XHR:n.gm.XMLHttpRequest,REQ:n.gm.Request,EV:n.gm.Event,PR:n.gm.Promise,MO:n.gm.MutationObserver,FETCH:n.gm.fetch,WS:n.gm.WebSocket},(0,s.i)(...Object.values(e.o))),e}function d(e,t){let r=o();r.initializedAgents??={},t.initializedAt={ms:(0,i.t)(),date:new Date},r.initializedAgents[e]=t}function u(e,t){o()[e]=t}function l(){return function(){let e=o();const t=e.info||{};e.info={beacon:a.beacon,errorBeacon:a.errorBeacon,...t}}(),function(){let e=o();const t=e.init||{};e.init={...t}}(),c(),function(){let e=o();const t=e.loader_config||{};e.loader_config={...t}}(),o()}},782:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewTiming},860:(e,t,r)=>{"use strict";r.d(t,{$J:()=>u,K7:()=>c,P3:()=>d,XX:()=>i,Yy:()=>o,df:()=>s,qY:()=>n,v4:()=>a});const n="events",i="jserrors",s="browser/blobs",a="rum",o="browser/logs",c={ajax:"ajax",genericEvents:"generic_events",jserrors:i,logging:"logging",metrics:"metrics",pageAction:"page_action",pageViewEvent:"page_view_event",pageViewTiming:"page_view_timing",sessionReplay:"session_replay",sessionTrace:"session_trace",softNav:"soft_navigations",spa:"spa"},d={[c.pageViewEvent]:1,[c.pageViewTiming]:2,[c.metrics]:3,[c.jserrors]:4,[c.spa]:5,[c.ajax]:6,[c.sessionTrace]:7,[c.softNav]:8,[c.sessionReplay]:9,[c.logging]:10,[c.genericEvents]:11},u={[c.pageViewEvent]:a,[c.pageViewTiming]:n,[c.ajax]:n,[c.spa]:n,[c.softNav]:n,[c.metrics]:i,[c.jserrors]:i,[c.sessionTrace]:s,[c.sessionReplay]:s,[c.logging]:o,[c.genericEvents]:"ins"}},944:(e,t,r)=>{"use strict";r.d(t,{R:()=>i});var n=r(3241);function i(e,t){"function"==typeof console.debug&&(console.debug("New Relic Warning: https://github.com/newrelic/newrelic-browser-agent/blob/main/docs/warning-codes.md#".concat(e),t),(0,n.W)({agentIdentifier:null,drained:null,type:"data",name:"warn",feature:"warn",data:{code:e,secondary:t}}))}},993:(e,t,r)=>{"use strict";r.d(t,{A$:()=>s,ET:()=>a,TZ:()=>o,p_:()=>i});var n=r(860);const i={ERROR:"ERROR",WARN:"WARN",INFO:"INFO",DEBUG:"DEBUG",TRACE:"TRACE"},s={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5},a="log",o=n.K7.logging},1541:(e,t,r)=>{"use strict";r.d(t,{U:()=>i,f:()=>n});const n={MFE:"MFE",BA:"BA"};function i(e,t){if(2!==t?.harvestEndpointVersion)return{};const r=t.agentRef.runtime.appMetadata.agents[0].entityGuid;return e?{"source.id":e.id,"source.name":e.name,"source.type":e.type,"parent.id":e.parent?.id||r,"parent.type":e.parent?.type||n.BA}:{"entity.guid":r,appId:t.agentRef.info.applicationID}}},1687:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>d,Ze:()=>h,x3:()=>u});var n=r(3241),i=r(7836),s=r(3606),a=r(860),o=r(2646);const c={};function d(e,t){const r={staged:!1,priority:a.P3[t]||0};l(e),c[e].get(t)||c[e].set(t,r)}function u(e,t){e&&c[e]&&(c[e].get(t)&&c[e].delete(t),p(e,t,!1),c[e].size&&f(e))}function l(e){if(!e)throw new Error("agentIdentifier required");c[e]||(c[e]=new Map)}function h(e="",t="feature",r=!1){if(l(e),!e||!c[e].get(t)||r)return p(e,t);c[e].get(t).staged=!0,f(e)}function f(e){const t=Array.from(c[e]);t.every(([e,t])=>t.staged)&&(t.sort((e,t)=>e[1].priority-t[1].priority),t.forEach(([t])=>{c[e].delete(t),p(e,t)}))}function p(e,t,r=!0){const a=e?i.ee.get(e):i.ee,c=s.i.handlers;if(!a.aborted&&a.backlog&&c){if((0,n.W)({agentIdentifier:e,type:"lifecycle",name:"drain",feature:t}),r){const e=a.backlog[t],r=c[t];if(r){for(let t=0;e&&t<e.length;++t)g(e[t],r);Object.entries(r).forEach(([e,t])=>{Object.values(t||{}).forEach(t=>{t[0]?.on&&t[0]?.context()instanceof o.y&&t[0].on(e,t[1])})})}}a.isolatedBacklog||delete c[t],a.backlog[t]=null,a.emit("drain-"+t,[])}}function g(e,t){var r=e[1];Object.values(t[r]||{}).forEach(t=>{var r=e[0];if(t[0]===r){var n=t[1],i=e[3],s=e[2];n.apply(i,s)}})}},1738:(e,t,r)=>{"use strict";r.d(t,{U:()=>f,Y:()=>h});var n=r(3241),i=r(9908),s=r(1863),a=r(944),o=r(5701),c=r(3969),d=r(8362),u=r(860),l=r(4261);function h(e,t,r,s){const h=s||r;!h||h[e]&&h[e]!==d.d.prototype[e]||(h[e]=function(){(0,i.p)(c.xV,["API/"+e+"/called"],void 0,u.K7.metrics,r.ee),(0,n.W)({agentIdentifier:r.agentIdentifier,drained:!!o.B?.[r.agentIdentifier],type:"data",name:"api",feature:l.Pl+e,data:{}});try{return t.apply(this,arguments)}catch(e){(0,a.R)(23,e)}})}function f(e,t,r,n,a){const o=e.info;null===r?delete o.jsAttributes[t]:o.jsAttributes[t]=r,(a||null===r)&&(0,i.p)(l.Pl+n,[(0,s.t)(),t,r],void 0,"session",e.ee)}},1741:(e,t,r)=>{"use strict";r.d(t,{W:()=>s});var n=r(944),i=r(4261);class s{#e(e,...t){if(this[e]!==s.prototype[e])return this[e](...t);(0,n.R)(35,e)}addPageAction(e,t){return this.#e(i.hG,e,t)}register(e){return this.#e(i.eY,e)}recordCustomEvent(e,t){return this.#e(i.fF,e,t)}setPageViewName(e,t){return this.#e(i.Fw,e,t)}setCustomAttribute(e,t,r){return this.#e(i.cD,e,t,r)}noticeError(e,t){return this.#e(i.o5,e,t)}setUserId(e,t=!1){return this.#e(i.Dl,e,t)}setApplicationVersion(e){return this.#e(i.nb,e)}setErrorHandler(e){return this.#e(i.bt,e)}addRelease(e,t){return this.#e(i.k6,e,t)}log(e,t){return this.#e(i.$9,e,t)}start(){return this.#e(i.d3)}finished(e){return this.#e(i.BL,e)}recordReplay(){return this.#e(i.CH)}pauseReplay(){return this.#e(i.Tb)}addToTrace(e){return this.#e(i.U2,e)}setCurrentRouteName(e){return this.#e(i.PA,e)}interaction(e){return this.#e(i.dT,e)}wrapLogger(e,t,r){return this.#e(i.Wb,e,t,r)}measure(e,t){return this.#e(i.V1,e,t)}consent(e){return this.#e(i.Pv,e)}}},1863:(e,t,r)=>{"use strict";function n(){return Math.floor(performance.now())}r.d(t,{t:()=>n})},1910:(e,t,r)=>{"use strict";r.d(t,{i:()=>s});var n=r(944);const i=new Map;function s(...e){return e.every(e=>{if(i.has(e))return i.get(e);const t="function"==typeof e?e.toString():"",r=t.includes("[native code]"),s=t.includes("nrWrapper");return r||s||(0,n.R)(64,e?.name||t),i.set(e,r),r})}},2555:(e,t,r)=>{"use strict";r.d(t,{D:()=>o,f:()=>a});var n=r(384),i=r(8122);const s={beacon:n.NT.beacon,errorBeacon:n.NT.errorBeacon,licenseKey:void 0,applicationID:void 0,sa:void 0,queueTime:void 0,applicationTime:void 0,ttGuid:void 0,user:void 0,account:void 0,product:void 0,extra:void 0,jsAttributes:{},userAttributes:void 0,atts:void 0,transactionName:void 0,tNamePlain:void 0};function a(e){try{return!!e.licenseKey&&!!e.errorBeacon&&!!e.applicationID}catch(e){return!1}}const o=e=>(0,i.a)(e,s)},2614:(e,t,r)=>{"use strict";r.d(t,{BB:()=>a,H3:()=>n,g:()=>d,iL:()=>c,tS:()=>o,uh:()=>i,wk:()=>s});const n="NRBA",i="SESSION",s=144e5,a=18e5,o={STARTED:"session-started",PAUSE:"session-pause",RESET:"session-reset",RESUME:"session-resume",UPDATE:"session-update"},c={SAME_TAB:"same-tab",CROSS_TAB:"cross-tab"},d={OFF:0,FULL:1,ERROR:2}},2646:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});class n{constructor(e){this.contextId=e}}},2843:(e,t,r)=>{"use strict";r.d(t,{G:()=>s,u:()=>i});var n=r(3878);function i(e,t=!1,r,i){(0,n.DD)("visibilitychange",function(){if(t)return void("hidden"===document.visibilityState&&e());e(document.visibilityState)},r,i)}function s(e,t,r){(0,n.sp)("pagehide",e,t,r)}},3241:(e,t,r)=>{"use strict";r.d(t,{W:()=>s});var n=r(6154);const i="newrelic";function s(e={}){try{n.gm.dispatchEvent(new CustomEvent(i,{detail:e}))}catch(e){}}},3304:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(7836);const i=()=>{const e=new WeakSet;return(t,r)=>{if("object"==typeof r&&null!==r){if(e.has(r))return;e.add(r)}return r}};function s(e){try{return JSON.stringify(e,i())??""}catch(e){try{n.ee.emit("internal-error",[e])}catch(e){}return""}}},3333:(e,t,r)=>{"use strict";r.d(t,{$v:()=>u,TZ:()=>n,Xh:()=>c,Zp:()=>i,kd:()=>d,mq:()=>o,nf:()=>a,qN:()=>s});const n=r(860).K7.genericEvents,i=["auxclick","click","copy","keydown","paste","scrollend"],s=["focus","blur"],a=4,o=1e3,c=2e3,d=["PageAction","UserAction","BrowserPerformance"],u={RESOURCES:"experimental.resources",REGISTER:"register"}},3434:(e,t,r)=>{"use strict";r.d(t,{Jt:()=>s,YM:()=>d});var n=r(7836),i=r(5607);const s="nr@original:".concat(i.W),a=50;var o=Object.prototype.hasOwnProperty,c=!1;function d(e,t){return e||(e=n.ee),r.inPlace=function(e,t,n,i,s){n||(n="");const a="-"===n.charAt(0);for(let o=0;o<t.length;o++){const c=t[o],d=e[c];l(d)||(e[c]=r(d,a?c+n:n,i,c,s))}},r.flag=s,r;function r(t,r,n,c,d){return l(t)?t:(r||(r=""),nrWrapper[s]=t,function(e,t,r){if(Object.defineProperty&&Object.keys)try{return Object.keys(e).forEach(function(r){Object.defineProperty(t,r,{get:function(){return e[r]},set:function(t){return e[r]=t,t}})}),t}catch(e){u([e],r)}for(var n in e)o.call(e,n)&&(t[n]=e[n])}(t,nrWrapper,e),nrWrapper);function nrWrapper(){var s,o,l,h;let f;try{o=this,s=[...arguments],l="function"==typeof n?n(s,o):n||{}}catch(t){u([t,"",[s,o,c],l],e)}i(r+"start",[s,o,c],l,d);const p=performance.now();let g;try{return h=t.apply(o,s),g=performance.now(),h}catch(e){throw g=performance.now(),i(r+"err",[s,o,e],l,d),f=e,f}finally{const e=g-p,t={start:p,end:g,duration:e,isLongTask:e>=a,methodName:c,thrownError:f};t.isLongTask&&i("long-task",[t,o],l,d),i(r+"end",[s,o,h],l,d)}}}function i(r,n,i,s){if(!c||t){var a=c;c=!0;try{e.emit(r,n,i,t,s)}catch(t){u([t,r,n,i],e)}c=a}}}function u(e,t){t||(t=n.ee);try{t.emit("internal-error",e)}catch(e){}}function l(e){return!(e&&"function"==typeof e&&e.apply&&!e[s])}},3606:(e,t,r)=>{"use strict";r.d(t,{i:()=>s});var n=r(9908);s.on=a;var i=s.handlers={};function s(e,t,r,s){a(s||n.d,i,e,t,r)}function a(e,t,r,i,s){s||(s="feature"),e||(e=n.d);var a=t[s]=t[s]||{};(a[r]=a[r]||[]).push([e,i])}},3738:(e,t,r)=>{"use strict";r.d(t,{He:()=>i,Kp:()=>o,Lc:()=>d,Rz:()=>u,TZ:()=>n,bD:()=>s,d3:()=>a,jx:()=>l,sl:()=>h,uP:()=>c});const n=r(860).K7.sessionTrace,i="bstResource",s="resource",a="-start",o="-end",c="fn"+a,d="fn"+o,u="pushState",l=1e3,h=3e4},3785:(e,t,r)=>{"use strict";r.d(t,{R:()=>c,b:()=>d});var n=r(9908),i=r(1863),s=r(860),a=r(3969),o=r(993);function c(e,t,r={},c=o.p_.INFO,d=!0,u,l=(0,i.t)()){(0,n.p)(a.xV,["API/logging/".concat(c.toLowerCase(),"/called")],void 0,s.K7.metrics,e),(0,n.p)(o.ET,[l,t,r,c,d,u],void 0,s.K7.logging,e)}function d(e){return"string"==typeof e&&Object.values(o.p_).some(t=>t===e.toUpperCase().trim())}},3878:(e,t,r)=>{"use strict";function n(e,t){return{capture:e,passive:!1,signal:t}}function i(e,t,r=!1,i){window.addEventListener(e,t,n(r,i))}function s(e,t,r=!1,i){document.addEventListener(e,t,n(r,i))}r.d(t,{DD:()=>s,jT:()=>n,sp:()=>i})},3962:(e,t,r)=>{"use strict";r.d(t,{AM:()=>a,O2:()=>l,OV:()=>s,Qu:()=>h,TZ:()=>c,ih:()=>f,pP:()=>o,t1:()=>u,tC:()=>i,wD:()=>d});var n=r(860);const i=["click","keydown","submit"],s="popstate",a="api",o="initialPageLoad",c=n.K7.softNav,d=5e3,u=500,l={INITIAL_PAGE_LOAD:"",ROUTE_CHANGE:1,UNSPECIFIED:2},h={INTERACTION:1,AJAX:2,CUSTOM_END:3,CUSTOM_TRACER:4},f={IP:"in progress",PF:"pending finish",FIN:"finished",CAN:"cancelled"}},3969:(e,t,r)=>{"use strict";r.d(t,{TZ:()=>n,XG:()=>o,rs:()=>i,xV:()=>a,z_:()=>s});const n=r(860).K7.metrics,i="sm",s="cm",a="storeSupportabilityMetrics",o="storeEventMetrics"},4234:(e,t,r)=>{"use strict";r.d(t,{W:()=>s});var n=r(7836),i=r(1687);class s{constructor(e,t){this.agentIdentifier=e,this.ee=n.ee.get(e),this.featureName=t,this.blocked=!1}deregisterDrain(){(0,i.x3)(this.agentIdentifier,this.featureName)}}},4261:(e,t,r)=>{"use strict";r.d(t,{$9:()=>u,BL:()=>c,CH:()=>p,Dl:()=>R,Fw:()=>w,PA:()=>v,Pl:()=>n,Pv:()=>A,Tb:()=>h,U2:()=>a,V1:()=>E,Wb:()=>T,bt:()=>y,cD:()=>b,d3:()=>x,dT:()=>d,eY:()=>g,fF:()=>f,hG:()=>s,hw:()=>i,k6:()=>o,nb:()=>m,o5:()=>l});const n="api-",i=n+"ixn-",s="addPageAction",a="addToTrace",o="addRelease",c="finished",d="interaction",u="log",l="noticeError",h="pauseReplay",f="recordCustomEvent",p="recordReplay",g="register",m="setApplicationVersion",v="setCurrentRouteName",b="setCustomAttribute",y="setErrorHandler",w="setPageViewName",R="setUserId",x="start",T="wrapLogger",E="measure",A="consent"},5205:(e,t,r)=>{"use strict";r.d(t,{j:()=>S});var n=r(384),i=r(1741);var s=r(2555),a=r(3333);const o=e=>{if(!e||"string"!=typeof e)return!1;try{document.createDocumentFragment().querySelector(e)}catch{return!1}return!0};var c=r(2614),d=r(944),u=r(8122);const l="[data-nr-mask]",h=e=>(0,u.a)(e,(()=>{const e={feature_flags:[],experimental:{allow_registered_children:!1,resources:!1},mask_selector:"*",block_selector:"[data-nr-block]",mask_input_options:{color:!1,date:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:!1,search:!1,tel:!1,text:!1,time:!1,url:!1,week:!1,textarea:!1,select:!1,password:!0}};return{ajax:{deny_list:void 0,block_internal:!0,enabled:!0,autoStart:!0},api:{get allow_registered_children(){return e.feature_flags.includes(a.$v.REGISTER)||e.experimental.allow_registered_children},set allow_registered_children(t){e.experimental.allow_registered_children=t},duplicate_registered_data:!1},browser_consent_mode:{enabled:!1},distributed_tracing:{enabled:void 0,exclude_newrelic_header:void 0,cors_use_newrelic_header:void 0,cors_use_tracecontext_headers:void 0,allowed_origins:void 0},get feature_flags(){return e.feature_flags},set feature_flags(t){e.feature_flags=t},generic_events:{enabled:!0,autoStart:!0},harvest:{interval:30},jserrors:{enabled:!0,autoStart:!0},logging:{enabled:!0,autoStart:!0},metrics:{enabled:!0,autoStart:!0},obfuscate:void 0,page_action:{enabled:!0},page_view_event:{enabled:!0,autoStart:!0},page_view_timing:{enabled:!0,autoStart:!0},performance:{capture_marks:!1,capture_measures:!1,capture_detail:!0,resources:{get enabled(){return e.feature_flags.includes(a.$v.RESOURCES)||e.experimental.resources},set enabled(t){e.experimental.resources=t},asset_types:[],first_party_domains:[],ignore_newrelic:!0}},privacy:{cookies_enabled:!0},proxy:{assets:void 0,beacon:void 0},session:{expiresMs:c.wk,inactiveMs:c.BB},session_replay:{autoStart:!0,enabled:!1,preload:!1,sampling_rate:10,error_sampling_rate:100,collect_fonts:!1,inline_images:!1,fix_stylesheets:!0,mask_all_inputs:!0,get mask_text_selector(){return e.mask_selector},set mask_text_selector(t){o(t)?e.mask_selector="".concat(t,",").concat(l):""===t||null===t?e.mask_selector=l:(0,d.R)(5,t)},get block_class(){return"nr-block"},get ignore_class(){return"nr-ignore"},get mask_text_class(){return"nr-mask"},get block_selector(){return e.block_selector},set block_selector(t){o(t)?e.block_selector+=",".concat(t):""!==t&&(0,d.R)(6,t)},get mask_input_options(){return e.mask_input_options},set mask_input_options(t){t&&"object"==typeof t?e.mask_input_options={...t,password:!0}:(0,d.R)(7,t)}},session_trace:{enabled:!0,autoStart:!0},soft_navigations:{enabled:!0,autoStart:!0},spa:{enabled:!0,autoStart:!0},ssl:void 0,user_actions:{enabled:!0,elementAttributes:["id","className","tagName","type"]}}})());var f=r(6154),p=r(9324);let g=0;const m={buildEnv:p.F3,distMethod:p.Xs,version:p.xv,originTime:f.WN},v={consented:!1},b={appMetadata:{},get consented(){return this.session?.state?.consent||v.consented},set consented(e){v.consented=e},customTransaction:void 0,denyList:void 0,disabled:!1,harvester:void 0,isolatedBacklog:!1,isRecording:!1,loaderType:void 0,maxBytes:3e4,obfuscator:void 0,onerror:void 0,ptid:void 0,releaseIds:{},session:void 0,timeKeeper:void 0,registeredEntities:[],jsAttributesMetadata:{bytes:0},get harvestCount(){return++g}},y=e=>{const t=(0,u.a)(e,b),r=Object.keys(m).reduce((e,t)=>(e[t]={value:m[t],writable:!1,configurable:!0,enumerable:!0},e),{});return Object.defineProperties(t,r)};var w=r(5701);const R=e=>{const t=e.startsWith("http");e+="/",r.p=t?e:"https://"+e};var x=r(7836),T=r(3241);const E={accountID:void 0,trustKey:void 0,agentID:void 0,licenseKey:void 0,applicationID:void 0,xpid:void 0},A=e=>(0,u.a)(e,E),_=new Set;function S(e,t={},r,a){let{init:o,info:c,loader_config:d,runtime:u={},exposed:l=!0}=t;if(!c){const e=(0,n.pV)();o=e.init,c=e.info,d=e.loader_config}e.init=h(o||{}),e.loader_config=A(d||{}),c.jsAttributes??={},f.bv&&(c.jsAttributes.isWorker=!0),e.info=(0,s.D)(c);const p=e.init,g=[c.beacon,c.errorBeacon];_.has(e.agentIdentifier)||(p.proxy.assets&&(R(p.proxy.assets),g.push(p.proxy.assets)),p.proxy.beacon&&g.push(p.proxy.beacon),e.beacons=[...g],function(e){const t=(0,n.pV)();Object.getOwnPropertyNames(i.W.prototype).forEach(r=>{const n=i.W.prototype[r];if("function"!=typeof n||"constructor"===n)return;let s=t[r];e[r]&&!1!==e.exposed&&"micro-agent"!==e.runtime?.loaderType&&(t[r]=(...t)=>{const n=e[r](...t);return s?s(...t):n})})}(e),(0,n.US)("activatedFeatures",w.B)),u.denyList=[...p.ajax.deny_list||[],...p.ajax.block_internal?g:[]],u.ptid=e.agentIdentifier,u.loaderType=r,e.runtime=y(u),_.has(e.agentIdentifier)||(e.ee=x.ee.get(e.agentIdentifier),e.exposed=l,(0,T.W)({agentIdentifier:e.agentIdentifier,drained:!!w.B?.[e.agentIdentifier],type:"lifecycle",name:"initialize",feature:void 0,data:e.config})),_.add(e.agentIdentifier)}},5270:(e,t,r)=>{"use strict";r.d(t,{Aw:()=>a,SR:()=>s,rF:()=>o});var n=r(384),i=r(7767);function s(e){return!!(0,n.dV)().o.MO&&(0,i.V)(e)&&!0===e?.session_trace.enabled}function a(e){return!0===e?.session_replay.preload&&s(e)}function o(e,t){try{if("string"==typeof t?.type){if("password"===t.type.toLowerCase())return"*".repeat(e?.length||0);if(void 0!==t?.dataset?.nrUnmask||t?.classList?.contains("nr-unmask"))return e}}catch(e){}return"string"==typeof e?e.replace(/[\S]/g,"*"):"*".repeat(e?.length||0)}},5289:(e,t,r)=>{"use strict";r.d(t,{GG:()=>a,Qr:()=>c,sB:()=>o});var n=r(3878),i=r(6389);function s(){return"undefined"==typeof document||"complete"===document.readyState}function a(e,t){if(s())return e();const r=(0,i.J)(e),a=setInterval(()=>{s()&&(clearInterval(a),r())},500);(0,n.sp)("load",r,t)}function o(e){if(s())return e();(0,n.DD)("DOMContentLoaded",e)}function c(e){if(s())return e();(0,n.sp)("popstate",e)}},5607:(e,t,r)=>{"use strict";r.d(t,{W:()=>n});const n=(0,r(9566).bz)()},5701:(e,t,r)=>{"use strict";r.d(t,{B:()=>s,t:()=>a});var n=r(3241);const i=new Set,s={};function a(e,t){const r=t.agentIdentifier;s[r]??={},e&&"object"==typeof e&&(i.has(r)||(t.ee.emit("rumresp",[e]),s[r]=e,i.add(r),(0,n.W)({agentIdentifier:r,loaded:!0,drained:!0,type:"lifecycle",name:"load",feature:void 0,data:e})))}},6154:(e,t,r)=>{"use strict";r.d(t,{OF:()=>d,RI:()=>i,WN:()=>h,bv:()=>s,eN:()=>f,gm:()=>a,lR:()=>l,m:()=>c,mw:()=>o,sb:()=>u});var n=r(1863);const i="undefined"!=typeof window&&!!window.document,s="undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self.navigator instanceof WorkerNavigator||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis.navigator instanceof WorkerNavigator),a=i?window:"undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis),o=Boolean("hidden"===a?.document?.visibilityState),c=""+a?.location,d=/iPad|iPhone|iPod/.test(a.navigator?.userAgent),u=d&&"undefined"==typeof SharedWorker,l=(()=>{const e=a.navigator?.userAgent?.match(/Firefox[/\s](\d+\.\d+)/);return Array.isArray(e)&&e.length>=2?+e[1]:0})(),h=Date.now()-(0,n.t)(),f=()=>"undefined"!=typeof PerformanceNavigationTiming&&a?.performance?.getEntriesByType("navigation")?.[0]?.responseStart},6344:(e,t,r)=>{"use strict";r.d(t,{BB:()=>u,Qb:()=>l,TZ:()=>i,Ug:()=>a,Vh:()=>s,_s:()=>o,bc:()=>d,yP:()=>c});var n=r(2614);const i=r(860).K7.sessionReplay,s="errorDuringReplay",a=.12,o={DomContentLoaded:0,Load:1,FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Custom:5},c={[n.g.ERROR]:15e3,[n.g.FULL]:3e5,[n.g.OFF]:0},d={RESET:{message:"Session was reset",sm:"Reset"},IMPORT:{message:"Recorder failed to import",sm:"Import"},TOO_MANY:{message:"429: Too Many Requests",sm:"Too-Many"},TOO_BIG:{message:"Payload was too large",sm:"Too-Big"},CROSS_TAB:{message:"Session Entity was set to OFF on another tab",sm:"Cross-Tab"},ENTITLEMENTS:{message:"Session Replay is not allowed and will not be started",sm:"Entitlement"}},u=5e3,l={API:"api",RESUME:"resume",SWITCH_TO_FULL:"switchToFull",INITIALIZE:"initialize",PRELOAD:"preload"}},6389:(e,t,r)=>{"use strict";function n(e,t=500,r={}){const n=r?.leading||!1;let i;return(...r)=>{n&&void 0===i&&(e.apply(this,r),i=setTimeout(()=>{i=clearTimeout(i)},t)),n||(clearTimeout(i),i=setTimeout(()=>{e.apply(this,r)},t))}}function i(e){let t=!1;return(...r)=>{t||(t=!0,e.apply(this,r))}}r.d(t,{J:()=>i,s:()=>n})},6630:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewEvent},6774:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.jserrors},7295:(e,t,r)=>{"use strict";r.d(t,{Xv:()=>a,gX:()=>i,iW:()=>s});var n=[];function i(e){if(!e||s(e))return!1;if(0===n.length)return!0;if("*"===n[0].hostname)return!1;for(var t=0;t<n.length;t++){var r=n[t];if(r.hostname.test(e.hostname)&&r.pathname.test(e.pathname))return!1}return!0}function s(e){return void 0===e.hostname}function a(e){if(n=[],e&&e.length)for(var t=0;t<e.length;t++){let r=e[t];if(!r)continue;if("*"===r)return void(n=[{hostname:"*"}]);0===r.indexOf("http://")?r=r.substring(7):0===r.indexOf("https://")&&(r=r.substring(8));const i=r.indexOf("/");let s,a;i>0?(s=r.substring(0,i),a=r.substring(i)):(s=r,a="*");let[c]=s.split(":");n.push({hostname:o(c),pathname:o(a,!0)})}}function o(e,t=!1){const r=e.replace(/[.+?^${}()|[\]\\]/g,e=>"\\"+e).replace(/\*/g,".*?");return new RegExp((t?"^":"")+r+"$")}},7485:(e,t,r)=>{"use strict";r.d(t,{D:()=>i});var n=r(6154);function i(e){if(0===(e||"").indexOf("data:"))return{protocol:"data"};try{const t=new URL(e,location.href),r={port:t.port,hostname:t.hostname,pathname:t.pathname,search:t.search,protocol:t.protocol.slice(0,t.protocol.indexOf(":")),sameOrigin:t.protocol===n.gm?.location?.protocol&&t.host===n.gm?.location?.host};return r.port&&""!==r.port||("http:"===t.protocol&&(r.port="80"),"https:"===t.protocol&&(r.port="443")),r.pathname&&""!==r.pathname?r.pathname.startsWith("/")||(r.pathname="/".concat(r.pathname)):r.pathname="/",r}catch(e){return{}}}},7699:(e,t,r)=>{"use strict";r.d(t,{It:()=>s,KC:()=>o,No:()=>i,qh:()=>a});var n=r(860);const i=16e3,s=1e6,a="SESSION_ERROR",o={[n.K7.logging]:!0,[n.K7.genericEvents]:!1,[n.K7.jserrors]:!1,[n.K7.ajax]:!1}},7767:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});var n=r(6154);const i=e=>n.RI&&!0===e?.privacy.cookies_enabled},7836:(e,t,r)=>{"use strict";r.d(t,{P:()=>o,ee:()=>c});var n=r(384),i=r(8990),s=r(2646),a=r(5607);const o="nr@context:".concat(a.W),c=function e(t,r){var n={},a={},u={},l=!1;try{l=16===r.length&&d.initializedAgents?.[r]?.runtime.isolatedBacklog}catch(e){}var h={on:p,addEventListener:p,removeEventListener:function(e,t){var r=n[e];if(!r)return;for(var i=0;i<r.length;i++)r[i]===t&&r.splice(i,1)},emit:function(e,r,n,i,s){!1!==s&&(s=!0);if(c.aborted&&!i)return;t&&s&&t.emit(e,r,n);var o=f(n);g(e).forEach(e=>{e.apply(o,r)});var d=v()[a[e]];d&&d.push([h,e,r,o]);return o},get:m,listeners:g,context:f,buffer:function(e,t){const r=v();if(t=t||"feature",h.aborted)return;Object.entries(e||{}).forEach(([e,n])=>{a[n]=t,t in r||(r[t]=[])})},abort:function(){h._aborted=!0,Object.keys(h.backlog).forEach(e=>{delete h.backlog[e]})},isBuffering:function(e){return!!v()[a[e]]},debugId:r,backlog:l?{}:t&&"object"==typeof t.backlog?t.backlog:{},isolatedBacklog:l};return Object.defineProperty(h,"aborted",{get:()=>{let e=h._aborted||!1;return e||(t&&(e=t.aborted),e)}}),h;function f(e){return e&&e instanceof s.y?e:e?(0,i.I)(e,o,()=>new s.y(o)):new s.y(o)}function p(e,t){n[e]=g(e).concat(t)}function g(e){return n[e]||[]}function m(t){return u[t]=u[t]||e(h,t)}function v(){return h.backlog}}(void 0,"globalEE"),d=(0,n.Zm)();d.ee||(d.ee=c)},8122:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var n=r(944);function i(e,t){try{if(!e||"object"!=typeof e)return(0,n.R)(3);if(!t||"object"!=typeof t)return(0,n.R)(4);const r=Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t)),s=0===Object.keys(r).length?e:r;for(let a in s)if(void 0!==e[a])try{if(null===e[a]){r[a]=null;continue}Array.isArray(e[a])&&Array.isArray(t[a])?r[a]=Array.from(new Set([...e[a],...t[a]])):"object"==typeof e[a]&&"object"==typeof t[a]?r[a]=i(e[a],t[a]):r[a]=e[a]}catch(e){r[a]||(0,n.R)(1,e)}return r}catch(e){(0,n.R)(2,e)}}},8139:(e,t,r)=>{"use strict";r.d(t,{u:()=>h});var n=r(7836),i=r(3434),s=r(8990),a=r(6154);const o={},c=a.gm.XMLHttpRequest,d="addEventListener",u="removeEventListener",l="nr@wrapped:".concat(n.P);function h(e){var t=function(e){return(e||n.ee).get("events")}(e);if(o[t.debugId]++)return t;o[t.debugId]=1;var r=(0,i.YM)(t,!0);function h(e){r.inPlace(e,[d,u],"-",p)}function p(e,t){return e[1]}return"getPrototypeOf"in Object&&(a.RI&&f(document,h),c&&f(c.prototype,h),f(a.gm,h)),t.on(d+"-start",function(e,t){var n=e[1];if(null!==n&&("function"==typeof n||"object"==typeof n)&&"newrelic"!==e[0]){var i=(0,s.I)(n,l,function(){var e={object:function(){if("function"!=typeof n.handleEvent)return;return n.handleEvent.apply(n,arguments)},function:n}[typeof n];return e?r(e,"fn-",null,e.name||"anonymous"):n});this.wrapped=e[1]=i}}),t.on(u+"-start",function(e){e[1]=this.wrapped||e[1]}),t}function f(e,t,...r){let n=e;for(;"object"==typeof n&&!Object.prototype.hasOwnProperty.call(n,d);)n=Object.getPrototypeOf(n);n&&t(n,...r)}},8362:(e,t,r)=>{"use strict";r.d(t,{d:()=>s});var n=r(9566),i=r(1741);class s extends i.W{agentIdentifier=(0,n.LA)(16)}},8374:(e,t,r)=>{r.nc=(()=>{try{return document?.currentScript?.nonce}catch(e){}return""})()},8990:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var n=Object.prototype.hasOwnProperty;function i(e,t,r){if(n.call(e,t))return e[t];var i=r();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!1}),i}catch(e){}return e[t]=i,i}},9119:(e,t,r)=>{"use strict";r.d(t,{L:()=>s});var n=/([^?#]*)[^#]*(#[^?]*|$).*/,i=/([^?#]*)().*/;function s(e,t){return e?e.replace(t?n:i,"$1$2"):e}},9300:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.ajax},9324:(e,t,r)=>{"use strict";r.d(t,{AJ:()=>a,F3:()=>i,Xs:()=>s,Yq:()=>o,xv:()=>n});const n="1.308.0",i="PROD",s="CDN",a="@newrelic/rrweb",o="1.0.1"},9566:(e,t,r)=>{"use strict";r.d(t,{LA:()=>o,ZF:()=>c,bz:()=>a,el:()=>d});var n=r(6154);const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function s(e,t){return e?15&e[t]:16*Math.random()|0}function a(){const e=n.gm?.crypto||n.gm?.msCrypto;let t,r=0;return e&&e.getRandomValues&&(t=e.getRandomValues(new Uint8Array(30))),i.split("").map(e=>"x"===e?s(t,r++).toString(16):"y"===e?(3&s()|8).toString(16):e).join("")}function o(e){const t=n.gm?.crypto||n.gm?.msCrypto;let r,i=0;t&&t.getRandomValues&&(r=t.getRandomValues(new Uint8Array(e)));const a=[];for(var o=0;o<e;o++)a.push(s(r,i++).toString(16));return a.join("")}function c(){return o(16)}function d(){return o(32)}},9908:(e,t,r)=>{"use strict";r.d(t,{d:()=>n,p:()=>i});var n=r(7836).ee.get("handle");function i(e,t,r,i,s){s?(s.buffer([e],i),s.emit(e,t,r)):(n.buffer([e],i),n.emit(e,t,r))}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return r[e](s,s.exports,i),s.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,r)=>(i.f[r](e,t),t),[])),i.u=e=>({212:"nr-spa-compressor",249:"nr-spa-recorder",478:"nr-spa"}[e]+"-1.308.0.min.js"),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="NRBA-1.308.0.PROD:",i.l=(r,n,s,a)=>{if(e[r])e[r].push(n);else{var o,c;if(void 0!==s)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var l=d[u];if(l.getAttribute("src")==r||l.getAttribute("data-webpack")==t+s){o=l;break}}if(!o){c=!0;var h={478:"sha512-RSfSVnmHk59T/uIPbdSE0LPeqcEdF4/+XhfJdBuccH5rYMOEZDhFdtnh6X6nJk7hGpzHd9Ujhsy7lZEz/ORYCQ==",249:"sha512-ehJXhmntm85NSqW4MkhfQqmeKFulra3klDyY0OPDUE+sQ3GokHlPh1pmAzuNy//3j4ac6lzIbmXLvGQBMYmrkg==",212:"sha512-B9h4CR46ndKRgMBcK+j67uSR2RCnJfGefU+A7FrgR/k42ovXy5x/MAVFiSvFxuVeEk/pNLgvYGMp1cBSK/G6Fg=="};(o=document.createElement("script")).charset="utf-8",i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",t+s),o.src=r,0!==o.src.indexOf(window.location.origin+"/")&&(o.crossOrigin="anonymous"),h[a]&&(o.integrity=h[a])}e[r]=[n];var f=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach(e=>e(n)),t)return t(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=f.bind(null,o.onerror),o.onload=f.bind(null,o.onload),c&&document.head.appendChild(o)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="https://js-agent.newrelic.com/",(()=>{var e={38:0,788:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var s=new Promise((r,i)=>n=e[t]=[r,i]);r.push(n[2]=s);var a=i.p+i.u(t),o=new Error;i.l(a,r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var s=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed: ("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,n[1](o)}},"chunk-"+t,t)}};var t=(t,r)=>{var n,s,[a,o,c]=r,d=0;if(a.some(t=>0!==e[t])){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(c)c(i)}for(t&&t(r);d<a.length;d++)s=a[d],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self["webpackChunk:NRBA-1.308.0.PROD"]=self["webpackChunk:NRBA-1.308.0.PROD"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";i(8374);var e=i(8362),t=i(860);const r=Object.values(t.K7);var n=i(5205);var s=i(9908),a=i(1863),o=i(4261),c=i(1738);var d=i(1687),u=i(4234),l=i(5289),h=i(6154),f=i(944),p=i(5270),g=i(7767),m=i(6389),v=i(7699);class b extends u.W{constructor(e,t){super(e.agentIdentifier,t),this.agentRef=e,this.abortHandler=void 0,this.featAggregate=void 0,this.loadedSuccessfully=void 0,this.onAggregateImported=new Promise(e=>{this.loadedSuccessfully=e}),this.deferred=Promise.resolve(),!1===e.init[this.featureName].autoStart?this.deferred=new Promise((t,r)=>{this.ee.on("manual-start-all",(0,m.J)(()=>{(0,d.Ak)(e.agentIdentifier,this.featureName),t()}))}):(0,d.Ak)(e.agentIdentifier,t)}importAggregator(e,t,r={}){if(this.featAggregate)return;const n=async()=>{let n;await this.deferred;try{if((0,g.V)(e.init)){const{setupAgentSession:t}=await i.e(478).then(i.bind(i,8766));n=t(e)}}catch(e){(0,f.R)(20,e),this.ee.emit("internal-error",[e]),(0,s.p)(v.qh,[e],void 0,this.featureName,this.ee)}try{if(!this.#t(this.featureName,n,e.init))return(0,d.Ze)(this.agentIdentifier,this.featureName),void this.loadedSuccessfully(!1);const{Aggregate:i}=await t();this.featAggregate=new i(e,r),e.runtime.harvester.initializedAggregates.push(this.featAggregate),this.loadedSuccessfully(!0)}catch(e){(0,f.R)(34,e),this.abortHandler?.(),(0,d.Ze)(this.agentIdentifier,this.featureName,!0),this.loadedSuccessfully(!1),this.ee&&this.ee.abort()}};h.RI?(0,l.GG)(()=>n(),!0):n()}#t(e,r,n){if(this.blocked)return!1;switch(e){case t.K7.sessionReplay:return(0,p.SR)(n)&&!!r;case t.K7.sessionTrace:return!!r;default:return!0}}}var y=i(6630),w=i(2614),R=i(3241);class x extends b{static featureName=y.T;constructor(e){var t;super(e,y.T),this.setupInspectionEvents(e.agentIdentifier),t=e,(0,c.Y)(o.Fw,function(e,r){"string"==typeof e&&("/"!==e.charAt(0)&&(e="/"+e),t.runtime.customTransaction=(r||"http://custom.transaction")+e,(0,s.p)(o.Pl+o.Fw,[(0,a.t)()],void 0,void 0,t.ee))},t),this.importAggregator(e,()=>i.e(478).then(i.bind(i,2467)))}setupInspectionEvents(e){const t=(t,r)=>{t&&(0,R.W)({agentIdentifier:e,timeStamp:t.timeStamp,loaded:"complete"===t.target.readyState,type:"window",name:r,data:t.target.location+""})};(0,l.sB)(e=>{t(e,"DOMContentLoaded")}),(0,l.GG)(e=>{t(e,"load")}),(0,l.Qr)(e=>{t(e,"navigate")}),this.ee.on(w.tS.UPDATE,(t,r)=>{(0,R.W)({agentIdentifier:e,type:"lifecycle",name:"session",data:r})})}}var T=i(384);class E extends e.d{constructor(e){var t;(super(),h.gm)?(this.features={},(0,T.bQ)(this.agentIdentifier,this),this.desiredFeatures=new Set(e.features||[]),this.desiredFeatures.add(x),(0,n.j)(this,e,e.loaderType||"agent"),t=this,(0,c.Y)(o.cD,function(e,r,n=!1){if("string"==typeof e){if(["string","number","boolean"].includes(typeof r)||null===r)return(0,c.U)(t,e,r,o.cD,n);(0,f.R)(40,typeof r)}else(0,f.R)(39,typeof e)},t),function(e){(0,c.Y)(o.Dl,function(t,r=!1){if("string"!=typeof t&&null!==t)return void(0,f.R)(41,typeof t);const n=e.info.jsAttributes["enduser.id"];r&&null!=n&&n!==t?(0,s.p)(o.Pl+"setUserIdAndResetSession",[t],void 0,"session",e.ee):(0,c.U)(e,"enduser.id",t,o.Dl,!0)},e)}(this),function(e){(0,c.Y)(o.nb,function(t){if("string"==typeof t||null===t)return(0,c.U)(e,"application.version",t,o.nb,!1);(0,f.R)(42,typeof t)},e)}(this),function(e){(0,c.Y)(o.d3,function(){e.ee.emit("manual-start-all")},e)}(this),function(e){(0,c.Y)(o.Pv,function(t=!0){if("boolean"==typeof t){if((0,s.p)(o.Pl+o.Pv,[t],void 0,"session",e.ee),e.runtime.consented=t,t){const t=e.features.page_view_event;t.onAggregateImported.then(e=>{const r=t.featAggregate;e&&!r.sentRum&&r.sendRum()})}}else(0,f.R)(65,typeof t)},e)}(this),this.run()):(0,f.R)(21)}get config(){return{info:this.info,init:this.init,loader_config:this.loader_config,runtime:this.runtime}}get api(){return this}run(){try{const e=function(e){const t={};return r.forEach(r=>{t[r]=!!e[r]?.enabled}),t}(this.init),n=[...this.desiredFeatures];n.sort((e,r)=>t.P3[e.featureName]-t.P3[r.featureName]),n.forEach(r=>{if(!e[r.featureName]&&r.featureName!==t.K7.pageViewEvent)return;if(r.featureName===t.K7.spa)return void(0,f.R)(67);const n=function(e){switch(e){case t.K7.ajax:return[t.K7.jserrors];case t.K7.sessionTrace:return[t.K7.ajax,t.K7.pageViewEvent];case t.K7.sessionReplay:return[t.K7.sessionTrace];case t.K7.pageViewTiming:return[t.K7.pageViewEvent];default:return[]}}(r.featureName).filter(e=>!(e in this.features));n.length>0&&(0,f.R)(36,{targetFeature:r.featureName,missingDependencies:n}),this.features[r.featureName]=new r(this)})}catch(e){(0,f.R)(22,e);for(const e in this.features)this.features[e].abortHandler?.();const t=(0,T.Zm)();delete t.initializedAgents[this.agentIdentifier]?.features,delete this.sharedAggregator;return t.ee.get(this.agentIdentifier).abort(),!1}}}var A=i(2843),_=i(782);class S extends b{static featureName=_.T;constructor(e){super(e,_.T),h.RI&&((0,A.u)(()=>(0,s.p)("docHidden",[(0,a.t)()],void 0,_.T,this.ee),!0),(0,A.G)(()=>(0,s.p)("winPagehide",[(0,a.t)()],void 0,_.T,this.ee)),this.importAggregator(e,()=>i.e(478).then(i.bind(i,9917))))}}var O=i(3969);class I extends b{static featureName=O.TZ;constructor(e){super(e,O.TZ),h.RI&&document.addEventListener("securitypolicyviolation",e=>{(0,s.p)(O.xV,["Generic/CSPViolation/Detected"],void 0,this.featureName,this.ee)}),this.importAggregator(e,()=>i.e(478).then(i.bind(i,6555)))}}var N=i(6774),P=i(3878),k=i(3304);class D{constructor(e,t,r,n,i){this.name="UncaughtError",this.message="string"==typeof e?e:(0,k.A)(e),this.sourceURL=t,this.line=r,this.column=n,this.__newrelic=i}}function C(e){return M(e)?e:new D(void 0!==e?.message?e.message:e,e?.filename||e?.sourceURL,e?.lineno||e?.line,e?.colno||e?.col,e?.__newrelic,e?.cause)}function j(e){const t="Unhandled Promise Rejection: ";if(!e?.reason)return;if(M(e.reason)){try{e.reason.message.startsWith(t)||(e.reason.message=t+e.reason.message)}catch(e){}return C(e.reason)}const r=C(e.reason);return(r.message||"").startsWith(t)||(r.message=t+r.message),r}function L(e){if(e.error instanceof SyntaxError&&!/:\d+$/.test(e.error.stack?.trim())){const t=new D(e.message,e.filename,e.lineno,e.colno,e.error.__newrelic,e.cause);return t.name=SyntaxError.name,t}return M(e.error)?e.error:C(e)}function M(e){return e instanceof Error&&!!e.stack}function H(e,r,n,i,o=(0,a.t)()){"string"==typeof e&&(e=new Error(e)),(0,s.p)("err",[e,o,!1,r,n.runtime.isRecording,void 0,i],void 0,t.K7.jserrors,n.ee),(0,s.p)("uaErr",[],void 0,t.K7.genericEvents,n.ee)}var B=i(1541),K=i(993),W=i(3785);function U(e,{customAttributes:t={},level:r=K.p_.INFO}={},n,i,s=(0,a.t)()){(0,W.R)(n.ee,e,t,r,!1,i,s)}function F(e,r,n,i,c=(0,a.t)()){(0,s.p)(o.Pl+o.hG,[c,e,r,i],void 0,t.K7.genericEvents,n.ee)}function V(e,r,n,i,c=(0,a.t)()){const{start:d,end:u,customAttributes:l}=r||{},h={customAttributes:l||{}};if("object"!=typeof h.customAttributes||"string"!=typeof e||0===e.length)return void(0,f.R)(57);const p=(e,t)=>null==e?t:"number"==typeof e?e:e instanceof PerformanceMark?e.startTime:Number.NaN;if(h.start=p(d,0),h.end=p(u,c),Number.isNaN(h.start)||Number.isNaN(h.end))(0,f.R)(57);else{if(h.duration=h.end-h.start,!(h.duration<0))return(0,s.p)(o.Pl+o.V1,[h,e,i],void 0,t.K7.genericEvents,n.ee),h;(0,f.R)(58)}}function G(e,r={},n,i,c=(0,a.t)()){(0,s.p)(o.Pl+o.fF,[c,e,r,i],void 0,t.K7.genericEvents,n.ee)}function z(e){(0,c.Y)(o.eY,function(t){return Y(e,t)},e)}function Y(e,r,n){(0,f.R)(54,"newrelic.register"),r||={},r.type=B.f.MFE,r.licenseKey||=e.info.licenseKey,r.blocked=!1,r.parent=n||{},Array.isArray(r.tags)||(r.tags=[]);const i={};r.tags.forEach(e=>{"name"!==e&&"id"!==e&&(i["source.".concat(e)]=!0)}),r.isolated??=!0;let o=()=>{};const c=e.runtime.registeredEntities;if(!r.isolated){const e=c.find(({metadata:{target:{id:e}}})=>e===r.id&&!r.isolated);if(e)return e}const d=e=>{r.blocked=!0,o=e};function u(e){return"string"==typeof e&&!!e.trim()&&e.trim().length<501||"number"==typeof e}e.init.api.allow_registered_children||d((0,m.J)(()=>(0,f.R)(55))),u(r.id)&&u(r.name)||d((0,m.J)(()=>(0,f.R)(48,r)));const l={addPageAction:(t,n={})=>g(F,[t,{...i,...n},e],r),deregister:()=>{d((0,m.J)(()=>(0,f.R)(68)))},log:(t,n={})=>g(U,[t,{...n,customAttributes:{...i,...n.customAttributes||{}}},e],r),measure:(t,n={})=>g(V,[t,{...n,customAttributes:{...i,...n.customAttributes||{}}},e],r),noticeError:(t,n={})=>g(H,[t,{...i,...n},e],r),register:(t={})=>g(Y,[e,t],l.metadata.target),recordCustomEvent:(t,n={})=>g(G,[t,{...i,...n},e],r),setApplicationVersion:e=>p("application.version",e),setCustomAttribute:(e,t)=>p(e,t),setUserId:e=>p("enduser.id",e),metadata:{customAttributes:i,target:r}},h=()=>(r.blocked&&o(),r.blocked);h()||c.push(l);const p=(e,t)=>{h()||(i[e]=t)},g=(r,n,i)=>{if(h())return;const o=(0,a.t)();(0,s.p)(O.xV,["API/register/".concat(r.name,"/called")],void 0,t.K7.metrics,e.ee);try{if(e.init.api.duplicate_registered_data&&"register"!==r.name){let e=n;if(n[1]instanceof Object){const t={"child.id":i.id,"child.type":i.type};e="customAttributes"in n[1]?[n[0],{...n[1],customAttributes:{...n[1].customAttributes,...t}},...n.slice(2)]:[n[0],{...n[1],...t},...n.slice(2)]}r(...e,void 0,o)}return r(...n,i,o)}catch(e){(0,f.R)(50,e)}};return l}class Z extends b{static featureName=N.T;constructor(e){var t;super(e,N.T),t=e,(0,c.Y)(o.o5,(e,r)=>H(e,r,t),t),function(e){(0,c.Y)(o.bt,function(t){e.runtime.onerror=t},e)}(e),function(e){let t=0;(0,c.Y)(o.k6,function(e,r){++t>10||(this.runtime.releaseIds[e.slice(-200)]=(""+r).slice(-200))},e)}(e),z(e);try{this.removeOnAbort=new AbortController}catch(e){}this.ee.on("internal-error",(t,r)=>{this.abortHandler&&(0,s.p)("ierr",[C(t),(0,a.t)(),!0,{},e.runtime.isRecording,r],void 0,this.featureName,this.ee)}),h.gm.addEventListener("unhandledrejection",t=>{this.abortHandler&&(0,s.p)("err",[j(t),(0,a.t)(),!1,{unhandledPromiseRejection:1},e.runtime.isRecording],void 0,this.featureName,this.ee)},(0,P.jT)(!1,this.removeOnAbort?.signal)),h.gm.addEventListener("error",t=>{this.abortHandler&&(0,s.p)("err",[L(t),(0,a.t)(),!1,{},e.runtime.isRecording],void 0,this.featureName,this.ee)},(0,P.jT)(!1,this.removeOnAbort?.signal)),this.abortHandler=this.#r,this.importAggregator(e,()=>i.e(478).then(i.bind(i,2176)))}#r(){this.removeOnAbort?.abort(),this.abortHandler=void 0}}var q=i(8990);let X=1;function J(e){const t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===h.gm?0:(0,q.I)(e,"nr@id",function(){return X++})}function Q(e){if("string"==typeof e&&e.length)return e.length;if("object"==typeof e){if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&e.byteLength)return e.byteLength;if("undefined"!=typeof Blob&&e instanceof Blob&&e.size)return e.size;if(!("undefined"!=typeof FormData&&e instanceof FormData))try{return(0,k.A)(e).length}catch(e){return}}}var ee=i(8139),te=i(7836),re=i(3434);const ne={},ie=["open","send"];function se(e){var t=e||te.ee;const r=function(e){return(e||te.ee).get("xhr")}(t);if(void 0===h.gm.XMLHttpRequest)return r;if(ne[r.debugId]++)return r;ne[r.debugId]=1,(0,ee.u)(t);var n=(0,re.YM)(r),i=h.gm.XMLHttpRequest,s=h.gm.MutationObserver,a=h.gm.Promise,o=h.gm.setInterval,c="readystatechange",d=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],u=[],l=h.gm.XMLHttpRequest=function(e){const t=new i(e),s=r.context(t);try{r.emit("new-xhr",[t],s),t.addEventListener(c,(a=s,function(){var e=this;e.readyState>3&&!a.resolved&&(a.resolved=!0,r.emit("xhr-resolved",[],e)),n.inPlace(e,d,"fn-",y)}),(0,P.jT)(!1))}catch(e){(0,f.R)(15,e);try{r.emit("internal-error",[e])}catch(e){}}var a;return t};function p(e,t){n.inPlace(t,["onreadystatechange"],"fn-",y)}if(function(e,t){for(var r in e)t[r]=e[r]}(i,l),l.prototype=i.prototype,n.inPlace(l.prototype,ie,"-xhr-",y),r.on("send-xhr-start",function(e,t){p(e,t),function(e){u.push(e),s&&(g?g.then(b):o?o(b):(m=-m,v.data=m))}(t)}),r.on("open-xhr-start",p),s){var g=a&&a.resolve();if(!o&&!a){var m=1,v=document.createTextNode(m);new s(b).observe(v,{characterData:!0})}}else t.on("fn-end",function(e){e[0]&&e[0].type===c||b()});function b(){for(var e=0;e<u.length;e++)p(0,u[e]);u.length&&(u=[])}function y(e,t){return t}return r}var ae="fetch-",oe=ae+"body-",ce=["arrayBuffer","blob","json","text","formData"],de=h.gm.Request,ue=h.gm.Response,le="prototype";const he={};function fe(e){const t=function(e){return(e||te.ee).get("fetch")}(e);if(!(de&&ue&&h.gm.fetch))return t;if(he[t.debugId]++)return t;function r(e,r,n){var i=e[r];"function"==typeof i&&(e[r]=function(){var e,r=[...arguments],s={};t.emit(n+"before-start",[r],s),s[te.P]&&s[te.P].dt&&(e=s[te.P].dt);var a=i.apply(this,r);return t.emit(n+"start",[r,e],a),a.then(function(e){return t.emit(n+"end",[null,e],a),e},function(e){throw t.emit(n+"end",[e],a),e})})}return he[t.debugId]=1,ce.forEach(e=>{r(de[le],e,oe),r(ue[le],e,oe)}),r(h.gm,"fetch",ae),t.on(ae+"end",function(e,r){var n=this;if(r){var i=r.headers.get("content-length");null!==i&&(n.rxSize=i),t.emit(ae+"done",[null,r],n)}else t.emit(ae+"done",[e],n)}),t}var pe=i(7485),ge=i(9566);class me{constructor(e){this.agentRef=e}generateTracePayload(e){const t=this.agentRef.loader_config;if(!this.shouldGenerateTrace(e)||!t)return null;var r=(t.accountID||"").toString()||null,n=(t.agentID||"").toString()||null,i=(t.trustKey||"").toString()||null;if(!r||!n)return null;var s=(0,ge.ZF)(),a=(0,ge.el)(),o=Date.now(),c={spanId:s,traceId:a,timestamp:o};return(e.sameOrigin||this.isAllowedOrigin(e)&&this.useTraceContextHeadersForCors())&&(c.traceContextParentHeader=this.generateTraceContextParentHeader(s,a),c.traceContextStateHeader=this.generateTraceContextStateHeader(s,o,r,n,i)),(e.sameOrigin&&!this.excludeNewrelicHeader()||!e.sameOrigin&&this.isAllowedOrigin(e)&&this.useNewrelicHeaderForCors())&&(c.newrelicHeader=this.generateTraceHeader(s,a,o,r,n,i)),c}generateTraceContextParentHeader(e,t){return"00-"+t+"-"+e+"-01"}generateTraceContextStateHeader(e,t,r,n,i){return i+"@nr=0-1-"+r+"-"+n+"-"+e+"----"+t}generateTraceHeader(e,t,r,n,i,s){if(!("function"==typeof h.gm?.btoa))return null;var a={v:[0,1],d:{ty:"Browser",ac:n,ap:i,id:e,tr:t,ti:r}};return s&&n!==s&&(a.d.tk=s),btoa((0,k.A)(a))}shouldGenerateTrace(e){return this.agentRef.init?.distributed_tracing?.enabled&&this.isAllowedOrigin(e)}isAllowedOrigin(e){var t=!1;const r=this.agentRef.init?.distributed_tracing;if(e.sameOrigin)t=!0;else if(r?.allowed_origins instanceof Array)for(var n=0;n<r.allowed_origins.length;n++){var i=(0,pe.D)(r.allowed_origins[n]);if(e.hostname===i.hostname&&e.protocol===i.protocol&&e.port===i.port){t=!0;break}}return t}excludeNewrelicHeader(){var e=this.agentRef.init?.distributed_tracing;return!!e&&!!e.exclude_newrelic_header}useNewrelicHeaderForCors(){var e=this.agentRef.init?.distributed_tracing;return!!e&&!1!==e.cors_use_newrelic_header}useTraceContextHeadersForCors(){var e=this.agentRef.init?.distributed_tracing;return!!e&&!!e.cors_use_tracecontext_headers}}var ve=i(9300),be=i(7295);function ye(e){return"string"==typeof e?e:e instanceof(0,T.dV)().o.REQ?e.url:h.gm?.URL&&e instanceof URL?e.href:void 0}var we=["load","error","abort","timeout"],Re=we.length,xe=(0,T.dV)().o.REQ,Te=(0,T.dV)().o.XHR;const Ee="X-NewRelic-App-Data";class Ae extends b{static featureName=ve.T;constructor(e){super(e,ve.T),this.dt=new me(e),this.handler=(e,t,r,n)=>(0,s.p)(e,t,r,n,this.ee);try{const e={xmlhttprequest:"xhr",fetch:"fetch",beacon:"beacon"};h.gm?.performance?.getEntriesByType("resource").forEach(r=>{if(r.initiatorType in e&&0!==r.responseStatus){const n={status:r.responseStatus},i={rxSize:r.transferSize,duration:Math.floor(r.duration),cbTime:0};_e(n,r.name),this.handler("xhr",[n,i,r.startTime,r.responseEnd,e[r.initiatorType]],void 0,t.K7.ajax)}})}catch(e){}fe(this.ee),se(this.ee),function(e,r,n,i){function o(e){var t=this;t.totalCbs=0,t.called=0,t.cbTime=0,t.end=T,t.ended=!1,t.xhrGuids={},t.lastSize=null,t.loadCaptureCalled=!1,t.params=this.params||{},t.metrics=this.metrics||{},t.latestLongtaskEnd=0,e.addEventListener("load",function(r){E(t,e)},(0,P.jT)(!1)),h.lR||e.addEventListener("progress",function(e){t.lastSize=e.loaded},(0,P.jT)(!1))}function c(e){this.params={method:e[0]},_e(this,e[1]),this.metrics={}}function d(t,r){e.loader_config.xpid&&this.sameOrigin&&r.setRequestHeader("X-NewRelic-ID",e.loader_config.xpid);var n=i.generateTracePayload(this.parsedOrigin);if(n){var s=!1;n.newrelicHeader&&(r.setRequestHeader("newrelic",n.newrelicHeader),s=!0),n.traceContextParentHeader&&(r.setRequestHeader("traceparent",n.traceContextParentHeader),n.traceContextStateHeader&&r.setRequestHeader("tracestate",n.traceContextStateHeader),s=!0),s&&(this.dt=n)}}function u(e,t){var n=this.metrics,i=e[0],s=this;if(n&&i){var o=Q(i);o&&(n.txSize=o)}this.startTime=(0,a.t)(),this.body=i,this.listener=function(e){try{"abort"!==e.type||s.loadCaptureCalled||(s.params.aborted=!0),("load"!==e.type||s.called===s.totalCbs&&(s.onloadCalled||"function"!=typeof t.onload)&&"function"==typeof s.end)&&s.end(t)}catch(e){try{r.emit("internal-error",[e])}catch(e){}}};for(var c=0;c<Re;c++)t.addEventListener(we[c],this.listener,(0,P.jT)(!1))}function l(e,t,r){this.cbTime+=e,t?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof r.onload||"function"!=typeof this.end||this.end(r)}function f(e,t){var r=""+J(e)+!!t;this.xhrGuids&&!this.xhrGuids[r]&&(this.xhrGuids[r]=!0,this.totalCbs+=1)}function p(e,t){var r=""+J(e)+!!t;this.xhrGuids&&this.xhrGuids[r]&&(delete this.xhrGuids[r],this.totalCbs-=1)}function g(){this.endTime=(0,a.t)()}function m(e,t){t instanceof Te&&"load"===e[0]&&r.emit("xhr-load-added",[e[1],e[2]],t)}function v(e,t){t instanceof Te&&"load"===e[0]&&r.emit("xhr-load-removed",[e[1],e[2]],t)}function b(e,t,r){t instanceof Te&&("onload"===r&&(this.onload=!0),("load"===(e[0]&&e[0].type)||this.onload)&&(this.xhrCbStart=(0,a.t)()))}function y(e,t){this.xhrCbStart&&r.emit("xhr-cb-time",[(0,a.t)()-this.xhrCbStart,this.onload,t],t)}function w(e){var t,r=e[1]||{};if("string"==typeof e[0]?0===(t=e[0]).length&&h.RI&&(t=""+h.gm.location.href):e[0]&&e[0].url?t=e[0].url:h.gm?.URL&&e[0]&&e[0]instanceof URL?t=e[0].href:"function"==typeof e[0].toString&&(t=e[0].toString()),"string"==typeof t&&0!==t.length){t&&(this.parsedOrigin=(0,pe.D)(t),this.sameOrigin=this.parsedOrigin.sameOrigin);var n=i.generateTracePayload(this.parsedOrigin);if(n&&(n.newrelicHeader||n.traceContextParentHeader))if(e[0]&&e[0].headers)o(e[0].headers,n)&&(this.dt=n);else{var s={};for(var a in r)s[a]=r[a];s.headers=new Headers(r.headers||{}),o(s.headers,n)&&(this.dt=n),e.length>1?e[1]=s:e.push(s)}}function o(e,t){var r=!1;return t.newrelicHeader&&(e.set("newrelic",t.newrelicHeader),r=!0),t.traceContextParentHeader&&(e.set("traceparent",t.traceContextParentHeader),t.traceContextStateHeader&&e.set("tracestate",t.traceContextStateHeader),r=!0),r}}function R(e,t){this.params={},this.metrics={},this.startTime=(0,a.t)(),this.dt=t,e.length>=1&&(this.target=e[0]),e.length>=2&&(this.opts=e[1]);var r=this.opts||{},n=this.target;_e(this,ye(n));var i=(""+(n&&n instanceof xe&&n.method||r.method||"GET")).toUpperCase();this.params.method=i,this.body=r.body,this.txSize=Q(r.body)||0}function x(e,r){if(this.endTime=(0,a.t)(),this.params||(this.params={}),(0,be.iW)(this.params))return;let i;this.params.status=r?r.status:0,"string"==typeof this.rxSize&&this.rxSize.length>0&&(i=+this.rxSize);const s={txSize:this.txSize,rxSize:i,duration:(0,a.t)()-this.startTime};n("xhr",[this.params,s,this.startTime,this.endTime,"fetch"],this,t.K7.ajax)}function T(e){const r=this.params,i=this.metrics;if(!this.ended){this.ended=!0;for(let t=0;t<Re;t++)e.removeEventListener(we[t],this.listener,!1);r.aborted||(0,be.iW)(r)||(i.duration=(0,a.t)()-this.startTime,this.loadCaptureCalled||4!==e.readyState?null==r.status&&(r.status=0):E(this,e),i.cbTime=this.cbTime,n("xhr",[r,i,this.startTime,this.endTime,"xhr"],this,t.K7.ajax))}}function E(e,n){e.params.status=n.status;var i=function(e,t){var r=e.responseType;return"json"===r&&null!==t?t:"arraybuffer"===r||"blob"===r||"json"===r?Q(e.response):"text"===r||""===r||void 0===r?Q(e.responseText):void 0}(n,e.lastSize);if(i&&(e.metrics.rxSize=i),e.sameOrigin&&n.getAllResponseHeaders().indexOf(Ee)>=0){var a=n.getResponseHeader(Ee);a&&((0,s.p)(O.rs,["Ajax/CrossApplicationTracing/Header/Seen"],void 0,t.K7.metrics,r),e.params.cat=a.split(", ").pop())}e.loadCaptureCalled=!0}r.on("new-xhr",o),r.on("open-xhr-start",c),r.on("open-xhr-end",d),r.on("send-xhr-start",u),r.on("xhr-cb-time",l),r.on("xhr-load-added",f),r.on("xhr-load-removed",p),r.on("xhr-resolved",g),r.on("addEventListener-end",m),r.on("removeEventListener-end",v),r.on("fn-end",y),r.on("fetch-before-start",w),r.on("fetch-start",R),r.on("fn-start",b),r.on("fetch-done",x)}(e,this.ee,this.handler,this.dt),this.importAggregator(e,()=>i.e(478).then(i.bind(i,3845)))}}function _e(e,t){var r=(0,pe.D)(t),n=e.params||e;n.hostname=r.hostname,n.port=r.port,n.protocol=r.protocol,n.host=r.hostname+":"+r.port,n.pathname=r.pathname,e.parsedOrigin=r,e.sameOrigin=r.sameOrigin}const Se={},Oe=["pushState","replaceState"];function Ie(e){const t=function(e){return(e||te.ee).get("history")}(e);return!h.RI||Se[t.debugId]++||(Se[t.debugId]=1,(0,re.YM)(t).inPlace(window.history,Oe,"-")),t}var Ne=i(3738);function Pe(e){(0,c.Y)(o.BL,function(r=Date.now()){const n=r-h.WN;n<0&&(0,f.R)(62,r),(0,s.p)(O.XG,[o.BL,{time:n}],void 0,t.K7.metrics,e.ee),e.addToTrace({name:o.BL,start:r,origin:"nr"}),(0,s.p)(o.Pl+o.hG,[n,o.BL],void 0,t.K7.genericEvents,e.ee)},e)}const{He:ke,bD:De,d3:Ce,Kp:je,TZ:Le,Lc:Me,uP:He,Rz:Be}=Ne;class Ke extends b{static featureName=Le;constructor(e){var r;super(e,Le),r=e,(0,c.Y)(o.U2,function(e){if(!(e&&"object"==typeof e&&e.name&&e.start))return;const n={n:e.name,s:e.start-h.WN,e:(e.end||e.start)-h.WN,o:e.origin||"",t:"api"};n.s<0||n.e<0||n.e<n.s?(0,f.R)(61,{start:n.s,end:n.e}):(0,s.p)("bstApi",[n],void 0,t.K7.sessionTrace,r.ee)},r),Pe(e);if(!(0,g.V)(e.init))return void this.deregisterDrain();const n=this.ee;let d;Ie(n),this.eventsEE=(0,ee.u)(n),this.eventsEE.on(He,function(e,t){this.bstStart=(0,a.t)()}),this.eventsEE.on(Me,function(e,r){(0,s.p)("bst",[e[0],r,this.bstStart,(0,a.t)()],void 0,t.K7.sessionTrace,n)}),n.on(Be+Ce,function(e){this.time=(0,a.t)(),this.startPath=location.pathname+location.hash}),n.on(Be+je,function(e){(0,s.p)("bstHist",[location.pathname+location.hash,this.startPath,this.time],void 0,t.K7.sessionTrace,n)});try{d=new PerformanceObserver(e=>{const r=e.getEntries();(0,s.p)(ke,[r],void 0,t.K7.sessionTrace,n)}),d.observe({type:De,buffered:!0})}catch(e){}this.importAggregator(e,()=>i.e(478).then(i.bind(i,6974)),{resourceObserver:d})}}var We=i(6344);class Ue extends b{static featureName=We.TZ;#n;recorder;constructor(e){var r;let n;super(e,We.TZ),r=e,(0,c.Y)(o.CH,function(){(0,s.p)(o.CH,[],void 0,t.K7.sessionReplay,r.ee)},r),function(e){(0,c.Y)(o.Tb,function(){(0,s.p)(o.Tb,[],void 0,t.K7.sessionReplay,e.ee)},e)}(e);try{n=JSON.parse(localStorage.getItem("".concat(w.H3,"_").concat(w.uh)))}catch(e){}(0,p.SR)(e.init)&&this.ee.on(o.CH,()=>this.#i()),this.#s(n)&&this.importRecorder().then(e=>{e.startRecording(We.Qb.PRELOAD,n?.sessionReplayMode)}),this.importAggregator(this.agentRef,()=>i.e(478).then(i.bind(i,6167)),this),this.ee.on("err",e=>{this.blocked||this.agentRef.runtime.isRecording&&(this.errorNoticed=!0,(0,s.p)(We.Vh,[e],void 0,this.featureName,this.ee))})}#s(e){return e&&(e.sessionReplayMode===w.g.FULL||e.sessionReplayMode===w.g.ERROR)||(0,p.Aw)(this.agentRef.init)}importRecorder(){return this.recorder?Promise.resolve(this.recorder):(this.#n??=Promise.all([i.e(478),i.e(249)]).then(i.bind(i,4866)).then(({Recorder:e})=>(this.recorder=new e(this),this.recorder)).catch(e=>{throw this.ee.emit("internal-error",[e]),this.blocked=!0,e}),this.#n)}#i(){this.blocked||(this.featAggregate?this.featAggregate.mode!==w.g.FULL&&this.featAggregate.initializeRecording(w.g.FULL,!0,We.Qb.API):this.importRecorder().then(()=>{this.recorder.startRecording(We.Qb.API,w.g.FULL)}))}}var Fe=i(3962);class Ve extends b{static featureName=Fe.TZ;constructor(e){if(super(e,Fe.TZ),function(e){const r=e.ee.get("tracer");function n(){}(0,c.Y)(o.dT,function(e){return(new n).get("object"==typeof e?e:{})},e);const i=n.prototype={createTracer:function(n,i){var o={},c=this,d="function"==typeof i;return(0,s.p)(O.xV,["API/createTracer/called"],void 0,t.K7.metrics,e.ee),function(){if(r.emit((d?"":"no-")+"fn-start",[(0,a.t)(),c,d],o),d)try{return i.apply(this,arguments)}catch(e){const t="string"==typeof e?new Error(e):e;throw r.emit("fn-err",[arguments,this,t],o),t}finally{r.emit("fn-end",[(0,a.t)()],o)}}}};["actionText","setName","setAttribute","save","ignore","onEnd","getContext","end","get"].forEach(r=>{c.Y.apply(this,[r,function(){return(0,s.p)(o.hw+r,[performance.now(),...arguments],this,t.K7.softNav,e.ee),this},e,i])}),(0,c.Y)(o.PA,function(){(0,s.p)(o.hw+"routeName",[performance.now(),...arguments],void 0,t.K7.softNav,e.ee)},e)}(e),!h.RI||!(0,T.dV)().o.MO)return;const r=Ie(this.ee);try{this.removeOnAbort=new AbortController}catch(e){}Fe.tC.forEach(e=>{(0,P.sp)(e,e=>{l(e)},!0,this.removeOnAbort?.signal)});const n=()=>(0,s.p)("newURL",[(0,a.t)(),""+window.location],void 0,this.featureName,this.ee);r.on("pushState-end",n),r.on("replaceState-end",n),(0,P.sp)(Fe.OV,e=>{l(e),(0,s.p)("newURL",[e.timeStamp,""+window.location],void 0,this.featureName,this.ee)},!0,this.removeOnAbort?.signal);let d=!1;const u=new((0,T.dV)().o.MO)((e,t)=>{d||(d=!0,requestAnimationFrame(()=>{(0,s.p)("newDom",[(0,a.t)()],void 0,this.featureName,this.ee),d=!1}))}),l=(0,m.s)(e=>{"loading"!==document.readyState&&((0,s.p)("newUIEvent",[e],void 0,this.featureName,this.ee),u.observe(document.body,{attributes:!0,childList:!0,subtree:!0,characterData:!0}))},100,{leading:!0});this.abortHandler=function(){this.removeOnAbort?.abort(),u.disconnect(),this.abortHandler=void 0},this.importAggregator(e,()=>i.e(478).then(i.bind(i,4393)),{domObserver:u})}}var Ge=i(3333),ze=i(9119);const Ye={},Ze=new Set;function qe(e){return"string"==typeof e?{type:"string",size:(new TextEncoder).encode(e).length}:e instanceof ArrayBuffer?{type:"ArrayBuffer",size:e.byteLength}:e instanceof Blob?{type:"Blob",size:e.size}:e instanceof DataView?{type:"DataView",size:e.byteLength}:ArrayBuffer.isView(e)?{type:"TypedArray",size:e.byteLength}:{type:"unknown",size:0}}class Xe{constructor(e,t){this.timestamp=(0,a.t)(),this.currentUrl=(0,ze.L)(window.location.href),this.socketId=(0,ge.LA)(8),this.requestedUrl=(0,ze.L)(e),this.requestedProtocols=Array.isArray(t)?t.join(","):t||"",this.openedAt=void 0,this.protocol=void 0,this.extensions=void 0,this.binaryType=void 0,this.messageOrigin=void 0,this.messageCount=0,this.messageBytes=0,this.messageBytesMin=0,this.messageBytesMax=0,this.messageTypes=void 0,this.sendCount=0,this.sendBytes=0,this.sendBytesMin=0,this.sendBytesMax=0,this.sendTypes=void 0,this.closedAt=void 0,this.closeCode=void 0,this.closeReason="unknown",this.closeWasClean=void 0,this.connectedDuration=0,this.hasErrors=void 0}}class $e extends b{static featureName=Ge.TZ;constructor(e){super(e,Ge.TZ);const r=e.init.feature_flags.includes("websockets"),n=[e.init.page_action.enabled,e.init.performance.capture_marks,e.init.performance.capture_measures,e.init.performance.resources.enabled,e.init.user_actions.enabled,r];var d;let u,l;if(d=e,(0,c.Y)(o.hG,(e,t)=>F(e,t,d),d),function(e){(0,c.Y)(o.fF,(t,r)=>G(t,r,e),e)}(e),Pe(e),z(e),function(e){(0,c.Y)(o.V1,(t,r)=>V(t,r,e),e)}(e),r&&(l=function(e){if(!(0,T.dV)().o.WS)return e;const t=e.get("websockets");if(Ye[t.debugId]++)return t;Ye[t.debugId]=1,(0,A.G)(()=>{const e=(0,a.t)();Ze.forEach(r=>{r.nrData.closedAt=e,r.nrData.closeCode=1001,r.nrData.closeReason="Page navigating away",r.nrData.closeWasClean=!1,r.nrData.openedAt&&(r.nrData.connectedDuration=e-r.nrData.openedAt),t.emit("ws",[r.nrData],r)})});class r extends WebSocket{static name="WebSocket";static toString(){return"function WebSocket() { [native code] }"}toString(){return"[object WebSocket]"}get[Symbol.toStringTag](){return r.name}#a(e){(e.__newrelic??={}).socketId=this.nrData.socketId,this.nrData.hasErrors??=!0}constructor(...e){super(...e),this.nrData=new Xe(e[0],e[1]),this.addEventListener("open",()=>{this.nrData.openedAt=(0,a.t)(),["protocol","extensions","binaryType"].forEach(e=>{this.nrData[e]=this[e]}),Ze.add(this)}),this.addEventListener("message",e=>{const{type:t,size:r}=qe(e.data);this.nrData.messageOrigin??=(0,ze.L)(e.origin),this.nrData.messageCount++,this.nrData.messageBytes+=r,this.nrData.messageBytesMin=Math.min(this.nrData.messageBytesMin||1/0,r),this.nrData.messageBytesMax=Math.max(this.nrData.messageBytesMax,r),(this.nrData.messageTypes??"").includes(t)||(this.nrData.messageTypes=this.nrData.messageTypes?"".concat(this.nrData.messageTypes,",").concat(t):t)}),this.addEventListener("close",e=>{this.nrData.closedAt=(0,a.t)(),this.nrData.closeCode=e.code,e.reason&&(this.nrData.closeReason=e.reason),this.nrData.closeWasClean=e.wasClean,this.nrData.connectedDuration=this.nrData.closedAt-this.nrData.openedAt,Ze.delete(this),t.emit("ws",[this.nrData],this)})}addEventListener(e,t,...r){const n=this,i="function"==typeof t?function(...e){try{return t.apply(this,e)}catch(e){throw n.#a(e),e}}:t?.handleEvent?{handleEvent:function(...e){try{return t.handleEvent.apply(t,e)}catch(e){throw n.#a(e),e}}}:t;return super.addEventListener(e,i,...r)}send(e){if(this.readyState===WebSocket.OPEN){const{type:t,size:r}=qe(e);this.nrData.sendCount++,this.nrData.sendBytes+=r,this.nrData.sendBytesMin=Math.min(this.nrData.sendBytesMin||1/0,r),this.nrData.sendBytesMax=Math.max(this.nrData.sendBytesMax,r),(this.nrData.sendTypes??"").includes(t)||(this.nrData.sendTypes=this.nrData.sendTypes?"".concat(this.nrData.sendTypes,",").concat(t):t)}try{return super.send(e)}catch(e){throw this.#a(e),e}}close(...e){try{super.close(...e)}catch(e){throw this.#a(e),e}}}return h.gm.WebSocket=r,t}(this.ee)),h.RI){if(fe(this.ee),se(this.ee),u=Ie(this.ee),e.init.user_actions.enabled){function f(t){const r=(0,pe.D)(t);return e.beacons.includes(r.hostname+":"+r.port)}function p(){u.emit("navChange")}Ge.Zp.forEach(e=>(0,P.sp)(e,e=>(0,s.p)("ua",[e],void 0,this.featureName,this.ee),!0)),Ge.qN.forEach(e=>{const t=(0,m.s)(e=>{(0,s.p)("ua",[e],void 0,this.featureName,this.ee)},500,{leading:!0});(0,P.sp)(e,t)}),h.gm.addEventListener("error",()=>{(0,s.p)("uaErr",[],void 0,t.K7.genericEvents,this.ee)},(0,P.jT)(!1,this.removeOnAbort?.signal)),this.ee.on("open-xhr-start",(e,r)=>{f(e[1])||r.addEventListener("readystatechange",()=>{2===r.readyState&&(0,s.p)("uaXhr",[],void 0,t.K7.genericEvents,this.ee)})}),this.ee.on("fetch-start",e=>{e.length>=1&&!f(ye(e[0]))&&(0,s.p)("uaXhr",[],void 0,t.K7.genericEvents,this.ee)}),u.on("pushState-end",p),u.on("replaceState-end",p),window.addEventListener("hashchange",p,(0,P.jT)(!0,this.removeOnAbort?.signal)),window.addEventListener("popstate",p,(0,P.jT)(!0,this.removeOnAbort?.signal))}if(e.init.performance.resources.enabled&&h.gm.PerformanceObserver?.supportedEntryTypes.includes("resource")){new PerformanceObserver(e=>{e.getEntries().forEach(e=>{(0,s.p)("browserPerformance.resource",[e],void 0,this.featureName,this.ee)})}).observe({type:"resource",buffered:!0})}}r&&l.on("ws",e=>{(0,s.p)("ws-complete",[e],void 0,this.featureName,this.ee)});try{this.removeOnAbort=new AbortController}catch(g){}this.abortHandler=()=>{this.removeOnAbort?.abort(),this.abortHandler=void 0},n.some(e=>e)?this.importAggregator(e,()=>i.e(478).then(i.bind(i,8019))):this.deregisterDrain()}}var Je=i(2646);const Qe=new Map;function et(e,t,r,n,i=!0){if("object"!=typeof t||!t||"string"!=typeof r||!r||"function"!=typeof t[r])return(0,f.R)(29);const s=function(e){return(e||te.ee).get("logger")}(e),a=(0,re.YM)(s),o=new Je.y(te.P);o.level=n.level,o.customAttributes=n.customAttributes,o.autoCaptured=i;const c=t[r]?.[re.Jt]||t[r];return Qe.set(c,o),a.inPlace(t,[r],"wrap-logger-",()=>Qe.get(c)),s}var tt=i(1910);class rt extends b{static featureName=K.TZ;constructor(e){var t;super(e,K.TZ),t=e,(0,c.Y)(o.$9,(e,r)=>U(e,r,t),t),function(e){(0,c.Y)(o.Wb,(t,r,{customAttributes:n={},level:i=K.p_.INFO}={})=>{et(e.ee,t,r,{customAttributes:n,level:i},!1)},e)}(e),z(e);const r=this.ee;["log","error","warn","info","debug","trace"].forEach(e=>{(0,tt.i)(h.gm.console[e]),et(r,h.gm.console,e,{level:"log"===e?"info":e})}),this.ee.on("wrap-logger-end",function([e]){const{level:t,customAttributes:n,autoCaptured:i}=this;(0,W.R)(r,e,n,t,i)}),this.importAggregator(e,()=>i.e(478).then(i.bind(i,5288)))}}new E({features:[Ae,x,S,Ke,Ue,I,Z,$e,rt,Ve],loaderType:"spa"})})()})();</script><style>
input.active {
    background: #5B8BEB !important;
    color: #fff;
}
.empty-div{
	overflow-x:scroll;
}
.ovrf-auto{
	overflow:scroll;
}
.dotDivchild
{
	position: absolute;
    width: 16px;
    height: 16px;
    padding-left: 3px;
    font-weight: bold;
    color:white;
}
.qExport-dotDivparent
{
    display: inline-block;
    height: 17px;
    width: 16px;
    border: 1px solid gray;
    margin: 1px;
    position: absolute;
    left: 335px;
    top: -2px;

}
.textDiv
{
	margin-left: 100px;
    font-weight: bold;
}
.textDiv2
{
	    font-weight: bold;
    color: darkblue;
    width: 70px;
    display: inline-block;
}
.empty-div
{
	height: 235px;
    margin: 3px;
    border: 1px solid black;

}
.checkboxStyle
{
	display: inline-block;
    margin-left: 95px;
    color: red;
    font-weight: bold;
}
.smlbox {
	float: right;
    width: 12px;
    height: 12px;
    margin-bottom: 2px;
    margin-right: 10px;
    border: 1px solid #464eb8 !important;
    position: relative;

}
.smlboxinside {
    position: absolute;
    width: 12px;
    background: #fff !important;
    height: 12px;
    top: 0%;
    left: 0%;
}
.smlboxinside::before {
	content: "\f00d";
	color: #464eb8;
    width: 12px;
    height: 12px;
    display: flex;
    align-items: center;
    align-items: center;
    justify-content: center;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: inherit;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
}
#nameLabel
{
	    margin-left: -120px;
    font-weight: bold;
}

.tbl-fixed-headers td {
    border-left: 1px solid #999 !important;
    height: 20px !important;
}

.report-list-active {
	 background-color:#5B8BEB;
}

</style>
</head>
<body>
<div class="app-layout-wrapper rsParentPopup_div" tabindex="-1" id='qExport-container'>
<input type="hidden" value="20/02/2026" id="currentMocCloseDate">
<input type="hidden" value="N" id="qExport-billLock">
<input type="hidden" value="Y" id="qExport-completeBeatPlg">
<input type="hidden" value="N" id="qExport-destSalesmanCheck">
<input type="hidden" value="1" id="qExport-enableTransaction">
<input type="hidden" value="Y" id="qExport-migrationFlag">
<input type="hidden" value="19" id="qExport-salesManCount">
<input type="hidden" value="3" id="qExport-rssmLimit">
<div class="pnl-wrapper pnl-border pnl-wid-6" style="width:675px;" id="qExport-dateContainer">     
			<div class="pnl-header">       
					<h4>Beat Export</h4>
					<div class="pnl-header-btns-hldr"> <a class="close"title="Close" id="cls-ssm" onclick="qExport_closeAndClear()"></a> <a class="minim" title="Minimize"  id="min-ssm"></a> <a class="help" title="Help"></a> </div>
			</div>
<!-- end of pnl-header -->     

  <!-- start of form-content -->

	<div class="form-content-area" style='padding: 10px 5px;'>
		
		<div class="col-2" style='width:48%'>
			<label style='color:darkblue;display: flex;align-items: center;'>Export From Date
				<!-- <input style='width:150px;position:absolute;margin-left:13px' type="text"  tabindex="4" id="qe-from-date"> -->
				<select id="qe-from-date" class = "focus-msg" style="margin-left: 8px;"> 
					<!-- -->
			   </select>
			</label>

		</div>
		<div class="col-2" style='width:48%'>
			<label style='color:darkblue;display: flex;align-items: center;'>Export To Date
			<!-- <input style='width:164px;position:absolute;margin-left:13px' type="text" tabindex="6" id="qe-to-date"> -->
				<select id="qe-to-date" class = "focus-msg" style="margin-left: 8px;"> 
					<!-- -->
			   	</select>
			</label>
		</div>

	</div>

	<div class="pnl-footer">
	
	<input type="button" id="qExport-exportDataButton" value="Beat Export and Sync " onclick="qExport_getSalesmanScreen()">
      <input type="button" id="qExport-closeButton" value="Close" style="width:65px" onclick="qExport_closeAndClear()">
    </div>
    <div  style="padding: 5px;background: #f0f0f0;border-top: 1px solid white; overflow: hidden;">
		<span id="lastBeatExportmsg" style="color: #b12e2e;font-size: 14px;font-weight: bold;"></span>
	</div>
	<!-- end of pnl-footer --> 
  </div>
  
  <!-- Salesman list start -->
 <div class="pnl-wrapper pnl-border pnl-wid-5" id="qExport-salesmanContainer" style="display: none;">     
 <div class="pnl-header">       
 <h4>Exporting data for following Salesperson</h4><div class="pnl-header-btns-hldr"> <a class="close" title="Close" id="cls-ssm"  onclick="qExport_closeSalesmanList()"></a> 
 <a class="minim" title="Minimize"  id="min-ssm"></a> <a class="help" title="Help"></a> 
 </div>     
 </div>
<!-- end of pnl-header -->    
 	    <!-- start of form-content -->

	<div class="form-content-area">
		<div class="col-1">
			<label style='color:darkblue;width:70%;display:inline-block'>Salesperson<input type='text' id ='qExport-listofSalesman' value="List Of Salespersons" ondragstart="return false;" ondrop="return false;" ></label>
			<div class='qExport-dotDivparent'><div id="select1" class="dotDivchild">...</div></div>

		</div>
	</div>
	 	    <!-- End of form-content -->

	    <!-- start of pnl-content -->

    <div class="pnl-content">
      <div class="ovrf-auto tableArrow" style="height:200px">

        <table class="tbl-fixed-headers" style="border:1px solid gray" id="qExport-salesmanTable">
          <thead>
            <tr>
              <th>#</th>
              <th>Salesperson Name</th>
              <th>Beat Name</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>

    <!-- end of pnl-content -->
    
    <!--Start of panel Footer -->
    <div class="pnl-footer">
    	
      <input type="button" value="Ok" style="width:65px;margin-right:40px" onclick="qExport_start()" id="ExportList-Ok-Btn">
      <input type="button" value="Cancel" onclick="qExport_closeSalesmanList()" style="width:65px" id="ExportList-Ok-Cancel">
    </div>
    <!-- end of pnl-footer --> 
  </div>
</div>
<!-- Salesman list end -->

<!--popup starts-->
<div class="pop-wrapper" id="qExport-slist" style="display: none;">
    <div class="pnl-wrapper pnl-border pnl-wid-5" style="top:53%">
    
      <div class="pnl-content">
        <div class="ovrf-auto" style="height:301px;margin-top:5px;">
        <div style="color:darkblue;text-align:center"><label id="nameLabel">Select RSSPs<div class="smlbox qExport-slist-close"><div class="smlboxinside"></div></div>
        </label></div>
              <div style="margin-top:5px"><div class='textDiv2'>Search By</div>
              <input type="text" id='qExport-rssmSearch' style="margin-left:10px;width:255px;display:inline-block">
              <div class='checkboxStyle'><input type='checkbox' id='qe_checkAll'>All</div></div>
               <div class="empty-div" id='qExport-slist-add' tabindex='-1'>
               		<!-- <div><input id="1" type="checkbox" checked><span id="text1" style="font-weight:bold">SMN00001-RAMAKRISHNA</span></div>
               		<div><input id="2" type="checkbox" checked><span id="text2" style="font-weight:bold">SMN00001-RAMAKRISHNA</span></div>
               		<div><input id="3"  type="checkbox" checked><span id="text3" style="font-weight:bold">SMN00001-RAMAKRISHNA</span></div> -->
               </div>
        </div>
      </div>
      <div class="pnl-footer">
      </div>
    </div>
  </div>
<!--popup ends-->

</div>

<link rel="stylesheet" type="text/css" href="/rsunify/resources/CSS/app-styles1.css?v=R26.1.0_20260129023001">     
<script>

var lastExportMsg = "Beat Exported till 06/02/2026 of 20/18 MEs and 36/100 beats";
var quantumExport = {};
quantumExport.getSalesmanUrl = '/rsunify/app/quantumExport/getSalesmanData';
quantumExport.startExport = '/rsunify/app/quantumExport/startExport';
quantumExport.getExportStatus = '/rsunify/app/quantumExport/getExportStatus';
quantumExport.checkBeatLink = '/rsunify/app/quantumExport/checkBeatLink';
quantumExport.checkSalemanProductLinkage = '/rsunify/app/quantumExport/checkSalemanProductLinkage';
quantumExport.getSalemanBeatLinkage = '/rsunify/app/salesmanBeatLink/loadSalesmanBeatLink';
quantumExport.callSfmIkeaIntegrationSync='/rsunify/app/sfmIkeaIntegration/callSfmIkeaIntegrationSync'
quantumExport.callcheckEmpStatus='/rsunify/app/sfmIkeaIntegration/checkEmpStatus' 
quantumExport.instantOutletCreation = '/rsunify/app/api/callikeatocommoutletcreationallapimethods'
quantumExport.salesmanList = [];
quantumExport.salesmanTableSize = null;
quantumExport.exportStatusFlag = false; 
quantumExport.exportStatusAjax = null; 
quantumExport.openSearch = 0; 
quantumExport.sfmIkeaIntegrationEnableFlag = JSON.parse("true");
quantumExport.isMocStart="FALSE";
quantumExport.beatCap ="9999";
quantumExport.outletCap ="9999";
quantumExport.popupflag = false;
quantumExport.filepath="";
$(function(){
	//var nextDay = moment().add(1, 'days').format('DD/MM/YYYY');
	if(lastExportMsg != ""){
		$("#lastBeatExportmsg").html(lastExportMsg);
	}
	setDateInFromAndToList();
    //$("#qe-from-date").attr("value", nextDay);
    //$("#qe-to-date").attr("value", nextDay);
    $('#qExport-dateContainer').vscontext({menuBlock: 'vs-context-menu'});
    $('#qExport-salesmanContainer').vscontext({menuBlock: 'vs-context-menu1'});
    $('#display-message').text('Select From Date').addClass("txt-black");
    $('#qe-from-date').focus();
    
	$('.date-pick').datePicker({
		startDate : '01/01/1000'
	});
	
	dateMaskFilter();
	
	
	$('#qExport-exportDataButton').on('keydown', function(e) {
		if(e.which==13){
			qExport_getSalesmanScreen();
		}
	});
	$('#qExport-closeButton').on('keydown', function(e) {
		if(e.which==13){
			qExport_closeAndClear();
		}
	});
	
	$('#qe-from-date').focusin(function() {
		$('#display-message').text('Select From Date').addClass("txt-black");
		$(this).parent('label').addClass('focused');
		$('#qe-to-date').parent('label').removeClass('focused');
	});
	
	$('#qe-to-date').focusin(function() {
		$('#display-message').text('Select To Date').addClass("txt-black");
		$(this).parent('label').addClass('focused');
		$('#qe-from-date').parent('label').removeClass('focused');
	});
	
	
	$('#qExport-listofSalesman').focusin(function() {
		$('#display-message').text('Press Spacebar Or Click The Button To Select Salespersons.').addClass("txt-black");
	});
	
	$('#qExport-rssmSearch').focusin(function() {
		$('#display-message').text('Press any key to search the list').addClass("txt-black");
	});
	
	$('#qExport-exportDataButton,#qExport-closeButton').focusin(function() {
		$('#display-message').text('Press Ctrl+G To Export Beat,Ctrl+O To Close').addClass("txt-black");
	});
	$('#qExport-rssmSearch').focusin(function() {
		$('#display-message').text('Press Ctrl+G To Export Beat,Ctrl+O To Close').addClass("txt-black");
	});
	
	$('#ExportList-Ok-Btn,#ExportList-Ok-Cancel').focusin(function() {
		$('#display-message').text('Press Ctrl+Q To Ok,Ctrl+C To Cancel').addClass("txt-black");
	});
	
	
/* 	$('#qe-from-date').change(function() {
		if(!moment(this.value, 'DD/MM/YYYY', true).isValid()) {
			$('#display-message').text('Enter Or Select From Date').removeClass("txt-black");
			$(this).focus();
		}
	});
	
	$('#qe-to-date').change(function() {
		if(!moment(this.value, 'DD/MM/YYYY', true).isValid()) {
			$('#display-message').text('Enter Or Select To Date').removeClass("txt-black");
			$(this).focus();
		}
	}); */
	
	
     
       /*  $('#qExport-salesmanTable').floatThead({
    	    position: 'absolute',
    	    scrollContainer: true
    	  });  */
    	  
    	  $('#qExport-container').on("click",'#qExport-salesmanTable tr td', function() {
    		  	//$('#qExport-salesmanTable tr td').removeClass('active');
    	  		//$(this).addClass('active');
    	  });
    	  
    	// list of saleman - space bar
  		$('#qExport-listofSalesman').on('keydown', function(e) {
  			 var theEvent = e || window.event;
  		 	 var key = theEvent.keyCode || theEvent.which;
  		 	 var charCode = theEvent.charCode;
  		 	 
  		 	 if(key == 32) {
  		 			qExport_filterSalesmanScreen();
  		 	 	 	return false;
  		 	 }
  		 	 
  			// allow arrow keys
  				if(charCode == 0 && $.inArray(key, [37, 39, 38, 40]) >= 0 )
  				    {
  				         return true;
  				    }
  			// allow shortcuts keys
  				if((theEvent.ctrlKey && $.inArray(key, [81, 79, 70, 79, 67]) >= 0)  || key == 27)
  				    {
  				         return true;
  				    }
  				if(key !=9){
  					theEvent.preventDefault();
  	  				theEvent.stopPropagation();
  				}
  		}); 
    	  
    	  
     //showing popup screen
       $('.qExport-dotDivparent').on("click",function() {
    	   qExport_filterSalesmanScreen();       		
       });

       //closing the popup screen
       $('.qExport-slist-close').on("click",function() {
    	   qExport_filterToListRssm();		
       });
       
       $('#qExport-container').on('change', '.qExport-chk', function() {
    	   var allChecked = 0;
    	   $('.qExport-chk').each(function() {
    		   if(this.checked) {
    			   allChecked++;
    		   }
    	   });
    	   
    	   if(quantumExport.salesmanList.length == allChecked) {
    		   $('#qe_checkAll')[0].checked = true;
    	   } else {
    		   $('#qe_checkAll')[0].checked = false;
    	   }
    	   
       });
       
       $('#qe_checkAll').on('change', function() {
    	   if(this.checked) {
    		   $('.qExport-chk').prop('checked', true);
    	   }
    	   else {
    		   $('.qExport-chk').prop('checked', false);
    	   }
       });
       
       
             
       $('#qExport-slist-add').on('keydown', 'div.chk-sel', function(e) {
   		var theEvent = e || window.event;
		 	var key = theEvent.keyCode || theEvent.which;
		 	var parentContainer = $(this).parent('div');
		 	var selectedDiv = parentContainer.find('div.sel-active');
		 if(key == 39 || key == 40) {
			if(selectedDiv.length > 0) {
				var nextDiv =  $(this).next('div');
				if(nextDiv.length > 0) {
					 nextDiv.attr('style','background-color:blue').addClass('sel-active').focus();
					 selectedDiv.removeAttr('style','background-color:blue').removeClass('sel-active');
				}
			} else {
				parentContainer.find('div:eq(0)').attr('style','background-color:blue').addClass('sel-active').focus();
			}
			theEvent.preventDefault();
			theEvent.stopPropagation();
		 	 return false;	
		 	}
		 else if(key == 37 || key == 38) {
				if(selectedDiv.length > 0) {
					var prevDiv =  $(this).prev('div');
					if(prevDiv.length > 0) {
						 prevDiv.attr('style','background-color:blue').addClass('sel-active').focus();
						 selectedDiv.removeAttr('style','background-color:blue').removeClass('sel-active');
					}
				} else {
					parentContainer.find('div:eq(0)').attr('style','background-color:blue').addClass('sel-active').focus();
				}
				theEvent.preventDefault();
				theEvent.stopPropagation();
		 		return false;	
		 	}
		 	
		 else if(key == 32) { 
			 if(selectedDiv.length > 0) {
				 selectedDiv.find('input').trigger('click');
			 }
			 
			 	theEvent.preventDefault();
				theEvent.stopPropagation();
				return false;
		 	 }
       });
       
       
       $('#qExport-slist-add').on('click', 'div', function(){
    	      $('#qExport-slist-add div').removeAttr('style','background-color:blue').removeClass('sel-active');;
    	      $(this).attr('style','background-color:blue');
    	      $(this).addClass('sel-active').focus();
    	    });
       
       
       $('#qExport-container').on('keydown', '#qExport-rssmSearch', function(e) {
    	   	var theEvent = e || window.event;
		 	var key = theEvent.keyCode || theEvent.which;
		 	 
		 	 if(key == 13) {
		 			qExport_filterToListRssm();	 
		 			theEvent.preventDefault();
					theEvent.stopPropagation();
		 	 }
		 	 
       });
       
       
       //search rssm
        $('#qExport-container').on('keyup', '#qExport-rssmSearch', function(e) {
  		 	 
        	// $('#qExport-slist-add').html('');
        	 //$('#qe_checkAll')[0].checked = false;
        	var searchText = $.trim($(this).val());
        	var chkString = '';
        	
        	if(searchText.length > 0) { 
        		$('#qExport-slist-add div.chk-sel').each(function() {
        				var spanText = $(this).find('span').text();
    	        		if(spanText.toUpperCase().indexOf(searchText.toUpperCase()) > -1) { 
    	        			$('#qExport-slist-add div.sel-active').removeAttr('style','background-color:blue').removeClass('sel-active');
    	        			//$(this).addClass('report-list-active');
    	        			$(this).attr('style','background-color:blue').addClass('sel-active');
    	        			return false;
    	        		}
        		});	
        	}
        	
        	/* if(searchText.length > 0) {
        		var filterCount = 0;
	   			$.each(quantumExport.salesmanList, function(idx, obj) {
	   				var spanText = obj.code+'-'+obj.name;
	        		if(spanText.toUpperCase().indexOf(searchText.toUpperCase()) > -1) {
	        				filterCount++;
	        				chkString = chkString + '<div tabindex="-1" class="chk-sel" ><input class="qExport-chk" value="'+idx+'" type="checkbox" checked><span style="font-weight:bold">'+obj.code+'-'+obj.name+'</span></div>';
	        			}
	   			});
	   			
	   			if(filterCount == quantumExport.salesmanList.length) {
	   			 		$('#qe_checkAll')[0].checked = true;
	   			}
   			
        	} else {
        		$.each(quantumExport.salesmanList, function(idx, obj) {
           			if(obj) {
           					chkString = chkString + '<div tabindex="-1" class="chk-sel" ><input class="qExport-chk" value="'+idx+'" type="checkbox" checked><span style="font-weight:bold">'+obj.code+'-'+obj.name+'</span></div>';
           			}
           		});
        		
        		 $('#qe_checkAll')[0].checked = true;
        	}
        	
        	 $('#qExport-slist-add').html(chkString); */
        });
       
  });
  
	/* $('#qExport-container').on('keydown', 'div.report-list-active', function(e) {
		 var theEvent = e || window.event;
		 var key = theEvent.keyCode || theEvent.which;
		 
		 if(key == 40) {
			 var nextDiv = $(this).next('div.chk-sel');
			 if(nextDiv.length > 0) {
				 $(this).removeClass('report-list-active');
				 nextDiv.addClass('report-list-active').focus();
			 }
		 } else if(key == 38) {
			 var prevDiv = $(this).prev('div.chk-sel');
			 if(prevDiv.length > 0) {
				 $(this).removeClass('report-list-active');
				 prevDiv.addClass('report-list-active').focus();
			 }
		 } else if(key == 32) {
			 $('#qExport-rssmSearch').focus();
		 }
	});

	$('#qExport-container').on('click', 'div.chk-sel', function(e) {
		$('#qExport-slist-add div.report-list-active').removeClass('report-list-active');
		 $(this).addClass('report-list-active').focus();
	}); */


// functions 
	function qExport_clear() {
		/* var nextDay = moment().add(1, 'days').format('DD/MM/YYYY');
	    $("#qe-from-date").val(nextDay);
	    $("#qe-to-date").val(nextDay);
	    $('#qe-from-date').focus(); */
	    setDateInFromAndToList();
	    $('#display-message').text('Data exported will be as per Salesperson Beat Link').addClass("txt-black");
	}
	
	function qExport_getSalesmanScreen() {
		$('.vs-context-menu').hide();
		$('.vs-context-menu1').hide();
		if(qExport_validationBeforeSalesman()) {
			salesman_validation();
		}
	}
	function salesman_validation(){
		// migration flag
		if($('#qExport-migrationFlag').val() == 'Y' ) {
				qExport_populateSalesmanData();
		} else {
			// salesman - product linkage count
			$.when(qExport_checkSalemanProductLinkage()).done(function(data) {
					if(data.length > 0) {
						$('#display-message').text( 'Product Group Linkage missing for Salesperson Code(s) '+data+' .Please setup Salesperson - product linkage in RSSP FCS Setup Screen to continue Export').removeClass("txt-black");
					} else {
						qExport_populateSalesmanData();
					}
					
					}).always(function() {
						 $('#qExport-container').unblock(); 
					});
		}
	}
	
	function qExport_checkSalemanProductLinkage() {
		var json  =  {
				fromDate:  moment($('#qe-from-date').val(), 'DD/MM/YYYY').format('YYYY-MM-DD') ,
				toDate:  moment($('#qe-to-date').val(), 'DD/MM/YYYY').format('YYYY-MM-DD')	
			};
			return $.ajax({
				async: false,
				url: quantumExport.checkSalemanProductLinkage,
				method: 'POST',
				cache: false,
			 	data: {
			 		'exportData' : JSON.stringify(json)
				},
				beforeSend : function(xhr) {
		        	if(allowMultiLogin())
						setAjaxHeaderCommon(xhr);
		        	 $('#qExport-container').block({ message: 'loading...' }); 
				},
			});
	}
	
	
	function qExport_getSalesmanData() {
		var json  =  {
			fromDate:  moment($('#qe-from-date').val(), 'DD/MM/YYYY').format('YYYY-MM-DD') ,
			toDate:  moment($('#qe-to-date').val(), 'DD/MM/YYYY').format('YYYY-MM-DD')	
		};
		return $.ajax({
			async: false,
			url: quantumExport.getSalesmanUrl,
			method: 'POST',
			cache: false,
			dataType: "JSON",
		 	data: {
		 		'exportData' : JSON.stringify(json)
			},
			beforeSend : function(xhr) {
	        	if(allowMultiLogin())
					setAjaxHeaderCommon(xhr);
	        	 $('#qExport-container').block({ message: 'loading...' }); 
			},
		});
	}
	
	function qExport_validationBeforeSalesman() {
		 if(quantumExport.isMocStart=="TRUE"){
				$('#qe-from-date').focus();
				$('#display-message').text('Beat Export halted temporarily because the Auto MOC close process is about to starts').removeClass("txt-black");
				return false;
		 }
		// Destination Saleman Chk & Enable Transaction validation
		if($('#qExport-destSalesmanCheck').val() == 'Y' && $('#qExport-enableTransaction').val() == '0') {
			var msg = 'Destination count has reduced, Please do inactive '+ (Number($('#qExport-salesManCount').val()) - Number($('#qExport-rssmLimit').val()))+' Salesperson code to do HHT Export';
			$('#display-message').text(msg).removeClass("txt-black");
			//$.messager.alert('Info',msg,'info');
			return false;
		}
		
		// other than u2
		//Bill Lock & Complete Beat Plg validation
		if($('#qExport-migrationFlag').val() == 'Y' && $('#qExport-billLock').val() == 'N' && $('#qExport-completeBeatPlg').val() == 'N') {
			//var msg = 'Sync with Center, Billing,Moc Closing and Market order & Collection/Export has been disabled.<br> ' +
		    // 'Please correct RSSM Beat Linkages.';
			var msg = 'Please Tag Unassigned beat in RSSP Beat PLG Link to continue with Transactions.';
			$('#display-message').text(msg).removeClass("txt-black");
			//$.messager.alert('Info',msg,'info');
			return false;
		}
		
		var fDate = $.trim($('#qe-from-date').val());
		var tDate = $.trim($('#qe-to-date').val());
		var fromDate = moment(fDate, 'DD/MM/YYYY');
		var toDate = moment(tDate, 'DD/MM/YYYY');
		var currentMocCloseDate = moment($('#currentMocCloseDate').val(), 'DD/MM/YYYY');
		
		if(parseStringToDate(fDate) == null) {
			$('#qe-from-date').focus();
			$('#display-message').text('Please Select Valid From Date').removeClass("txt-black");
			return false;
		}
		
		if(parseStringToDate(tDate) == null) {
			$('#qe-to-date').focus();
			$('#display-message').text('Please Select Valid To Date').removeClass("txt-black");
			return false;
		}
		
		if(!fromDate.isValid()) {
			$('#qe-from-date').focus();
			$('#display-message').text('Select From Date').removeClass("txt-black");
			return false;
		}
		
		if(!toDate.isValid()) {
			$('#qe-to-date').focus();
			$('#display-message').text('Select To Date').removeClass("txt-black");
			return false;
		}
		
		if(moment(moment().format('YYYY-MM-DD')).isAfter(fromDate.format('YYYY-MM-DD'))) {
			$('#qe-from-date').focus();
			$('#display-message').text('From Date cannot be Less then system date').removeClass("txt-black");
			return false;
		}
		
		if(fromDate.isAfter(toDate)) {
			$('#qe-to-date').focus();
			$('#display-message').text('To Date Should Be Greater Than From Date').removeClass("txt-black");
			return false;
		}
		
		 if(toDate.isAfter(currentMocCloseDate)) {
			$('#qe-to-date').focus();
			$('#display-message').text('To Date Cannot Be Greater Than Current MOC').removeClass("txt-black");
			return false;
		}   
		
		 if(toDate.diff(fromDate, 'days') > 6) {
			 $('#qe-to-date').focus();
			 $('#display-message').text('No Salesperson beat Link for selected date').addClass("txt-black");//.removeClass("txt-black");
			 return false;
		 }
		 downloadExportFailedDetails();
		 
		 
	}
	function qexport_salExclu_validation(){
		if (quantumExport.popupflag){
			 var message = "Export is not allowed for one or more Salesperson because too many beats or outlets tagged. Please revise beat linkage and retry for them. Click on"+"<a id='pending-task-mnu_excl' href='#' style='font-size: 14px !important;font-weight: bold;color: blue;' onClick='downloadExportFailedExcel()'> Download </a>"+" for the excluded list or click on "+"Continue"+" below to do export for rest of the Salesperson.";
			 dlg = $.messager.alert({
					title : 'Information',
					icon: "info",
					width:650,
					msg : message,
					onClose : function(){
	    				dlg.dialog('destroy');
	    				$('#display-message').text('');
	    				return qExport_Validation();
					},
					buttons : [{
						id : 'ok',
						text : 'Continue',
						onClick : function() {
							dlg.dialog('destroy');	
							$('#display-message').text('');
							return qExport_Validation();
						}
					}]
				});			 
		 }else {
			 qExport_Validation();
		 }
	}
	function qExport_Validation() {
		var beatLinkFlag = false;
		var isAnyDateAutoExport = false;
		$.when(qExport_checkBeatLink()).done(function(data) {
			if ( data.isAnyDateAutoExport != 0 ) {
				isAnyDateAutoExport = true;
			}
			if(data.beatLinkCount > 0) {
				beatLinkFlag = true;
			}
		}).always(function() {
			 $('#qExport-container').unblock(); 
		});
		if(!beatLinkFlag) {
			$('#qe-to-date').focus();
			$('#display-message').text('No Salesperson beat Link for selected date').removeClass("txt-black");
			return false;
		} else if ( isAnyDateAutoExport ) {
			dlg = $.messager.alert({
				title : 'Information',
				icon: "info",
				width:650,
				msg : 'Last exported beat data will be removed from Salesperson Application with latest beat.',
				buttons : [{
					id : 'ok',
					text : 'OK',
					onClick : function() {
						dlg.dialog('destroy');	
						$('#display-message').text('');
						qExport_populateSalesmanData();
					}
				}]
			});
		} else {
			return salesman_validation();
		}
				
	}
	function qExport_filterToListRssm() {
			$('#qExport-salesmanTable tbody tr').hide();
    	
	    	$('#qExport-slist-add input:checkbox').each(function() {
	    		var obj = quantumExport.salesmanList[this.value];
	    		if(this.checked) {
						$('#qExport-salesmanTable tbody tr[qe-salesman-id="'+obj.id+'"]').show();
					} 
	    	});
			
       		qExport_rearrangeIdx(quantumExport.salesmanTableSize);
       		$('#qExport-slist').hide();
       		$('.pnl-footer input').css('visibility', 'visible');
       		//$('#qExport-salesmanTable tbody td').removeClass('active');
       		$('#qExport-listofSalesman').focus();
	}
	
	function qExport_checkBeatLink() {
		var json  =  {
				fromDate:  moment($('#qe-from-date').val(), 'DD/MM/YYYY').format('YYYY-MM-DD') ,
				toDate:  moment($('#qe-to-date').val(), 'DD/MM/YYYY').format('YYYY-MM-DD')	
			};
			return $.ajax({
				async: false,
				url: quantumExport.checkBeatLink,
				method: 'POST',
				cache: false,
				dataType: "JSON",
			 	data: {
			 		'exportData' : JSON.stringify(json)
				},
				beforeSend : function(xhr) {
						        	if(allowMultiLogin())
										setAjaxHeaderCommon(xhr);
						        	 $('#qExport-container').block({ message: 'loading...' }); 
				},
			});
	}
	function qExport_salesmanData(){
	$.when(qExport_getSalesmanData()).done(function(data) {
		if(data.length > 0) {
			var salesman = [];
			var salesmanHtml = [];
			var salesmanBeat = [];
			
			data.sort(function(a, b) {
       			if ( a[2] < b[2] )
       			  return -1;
       			if ( a[2] > b[2] )
       			  return 1;
       			return 0;
       		}); 
			
			$.each(data, function(idx){
				var row = data[idx];
				if($.inArray(row[0], salesman) == -1) {
					salesman.push(row[0]);
					quantumExport.salesmanList.push({
						id: row[0],
						code: row[1],
						name: row[2],
					});
					salesmanHtml.push(['<tr qe-salesman-code="'+row[1]+'" qe-salesman-id="'+row[0]+'" qe-beat-id="'+row[3]+'"><td>'+(idx + 1)+'</td><td tabindex="-1" class="rsParentPopup_cell qe-salesman" >'+row[2]+'</td> <td tabindex="-1" class="rsParentPopup_cell qe-beat" >'+row[4]+'</td></tr>']);
				} else {
					salesmanHtml[salesman.indexOf(row[0])].push('<tr qe-salesman-id="'+row[0]+'" qe-beat-id="'+row[3]+'"><td>'+(idx + 1)+'</td><td tabindex="-1" class="rsParentPopup_cell qe-salesman" ></td> <td tabindex="-1" class="rsParentPopup_cell qe-beat" >'+row[4]+'</td></tr>');
				}
			});
			
			 quantumExport.salesmanList.sort(function(a, b) {
		       			if ( a.code < b.code )
		       			  return -1;
		       			if ( a.code > b.code )
		       			  return 1;
		       			return 0;
		       		}); 
		       		
			$('#qExport-salesmanTable tbody').html(salesmanHtml.join(''));
			qExport_createEmptyRow(10,false);
			quantumExport.salesmanTableSize = $('#qExport-salesmanTable tbody tr').length;
			//qExport_createEmptyRow(20, false);
		}
	}).always(function(e) {
		$('#qExport-container').unblock();
	});
	$('#qExport-dateContainer').hide();
	$('#qExport-salesmanContainer').show();
	$('#qExport-listofSalesman').focus();
}
	function qExport_populateSalesmanData() {
		if(quantumExport.sfmIkeaIntegrationEnableFlag){
			callSfmIkeaIntegrationSync(0);				
		}else{
			//qExport_salesmanData();
			instantOutletCreation(0);
		}
	}
	
	function instantOutletCreation(scr){ 
		$.ajax({
		method: 'POST',
		url: quantumExport.instantOutletCreation,
		async: false,
		cache: false,
		beforeSend : function(xhr) {
        	if(allowMultiLogin())
				setAjaxHeaderCommon(xhr);			
		},
		success: function(data) {
		}
	    });
		if (scr == 0){
			qExport_salesmanData();
		}
	}
	
function qExport_closeSalesmanList()
{
	quantumExport.openSearch = 0;
	$('#display-message').text('');
	quantumExport.salesmanList = [];
	quantumExport.salesmanTableSize = null;
	$('#qExport-salesmanContainer').hide();
	$('#qExport-dateContainer').show();
	$('.vs-context-menu').hide();
	$('.vs-context-menu1').hide();
	$('#qe-from-date').focus();
}

	function qExport_filterSalesmanScreen() {
		if(quantumExport.openSearch == 0) {
			$('#qExport-slist-add').html('');
	   		$('#qe_checkAll')[0].checked = true;
	   		$.each(quantumExport.salesmanList, function(idx, obj) {
	   			if(obj) {
	   					$('#qExport-slist-add').append('<div tabindex="-1" class="chk-sel"><input class="qExport-chk" value="'+idx+'" type="checkbox" checked><span style="font-weight:bold">'+obj.code+'-'+obj.name+'</span></div>');
	   			}
	   		});
		}
		quantumExport.openSearch++;
		$('#qExport-rssmSearch').val('');
		$('#qExport-slist-add div.sel-active').removeAttr('style','background-color:blue').removeClass('sel-active');
   		$('.pnl-footer input').css('visibility', 'hidden');
   		$('#qExport-slist').show();
   		$('#qExport-rssmSearch').focus();
	}

// 
function qExport_rearrangeIdx(minRowSize) {
	var tableObj = $('#qExport-salesmanTable tbody');
	var visibleTr = tableObj.find('tr:visible');
	var currentRowSize = visibleTr.length;
	var idx = 1;
	visibleTr.each(function(){
		$(this).find('td:eq(0)').text(idx);
		idx++;
	});
	
	for(;currentRowSize < minRowSize;currentRowSize++){
		tableObj.append('<tr><td>'+(currentRowSize+1)+'</td><td></td><td></td></tr>');
	}
	
}

function qExport_createEmptyRow(minRowSize, clearTable) {
	var tableObj = $('#qExport-salesmanTable tbody');
	if(clearTable == true) {
		tableObj.empty();
	}
	var currentRowSize = tableObj.find('tr').length;
	if(currentRowSize < minRowSize) {
		
		for(;currentRowSize < minRowSize;currentRowSize++){
			tableObj.append('<tr><td>'+(currentRowSize+1)+'</td><td></td><td></td></tr>');
		}	
	}
}

		function qExport_closeAndClear(){
			/* $('#display-message').text('');
			if($('#quantumExport').is(':visible')){
				$('#quantumExport').hide();
				$('#quantumExport').html('');
				$('#display-message').text('');
				$('#activeDiv').find('div p span').each(function(){
					if($(this).text() == 'Beat Export'){
						$(this).parent().remove();
					}
				});
			} */
			
			closePanel();
		}

		var closeScreensOnClick = 0;
		
		//Closing the Panel
		function closePanel() {
			if(!quantumExport.exportStatusFlag) {
				$('#display-message').text("");
				closeScreensOnClick = 1;
				//validateImportDataCloseMultiUsers();
				parent.window.opener.updateScreenStatus('Beat Export',1);
			    window.close();
			}
		}
		
		$(window).bind('beforeunload',function(event) {
			if(closeScreensOnClick == 0){
				event.preventDefault();
				event.stopPropagation();
				if (quantumExport.exportStatusFlag) {
					return false;
				}
				closePanel();
			}
		});


	function qExport_start() {
		var activeTd = $('#qExport-salesmanTable tbody td.active');
		var parentTr = activeTd.parent('tr');
		var salesmanId = '';
		var beatId = '';
		
		var fromDate = moment($('#qe-from-date').val(), 'DD/MM/YYYY').format('YYYY-MM-DD');
		var toDate = moment($('#qe-to-date').val(), 'DD/MM/YYYY').format('YYYY-MM-DD');
		
		// all beat id..
		var salesManIdArray = [];
		$('#qExport-salesmanTable tbody tr:visible').each(function() {
			var attr = $(this).attr('qe-salesman-id');
			if (typeof attr !== typeof undefined && attr !== false) {
				if( $.inArray(attr, salesManIdArray) == -1 ){
					salesManIdArray.push(attr);
				}	
			}
		});
		
		salesmanId = salesManIdArray.join(',');
		beatId = 'ALL';
		
		/* var parentTrSalemanId = $(parentTr).attr('qe-salesman-id')
		if(activeTd.length > 0 && (typeof parentTrSalemanId !== typeof undefined) && (parentTrSalemanId !== false)) {
			if(activeTd.hasClass('qe-beat')) {
				beatId = parentTr.attr('qe-beat-id');
			} else {
				if(activeTd.hasClass('qe-salesman')) {
					if(activeTd.text().length > 0) {
						beatId = 'ALL';
					} else {
						beatId = parentTr.attr('qe-beat-id');
					}
				}
			}			
			salesmanId = parentTr.attr('qe-salesman-id');
		} else {
			// all beat id..
			var salesManIdArray = [];
			$('#qExport-salesmanTable tbody tr:visible').each(function() {
				var attr = $(this).attr('qe-salesman-id');
				if (typeof attr !== typeof undefined && attr !== false) {
					if( $.inArray(attr, salesManIdArray) == -1 ){
						salesManIdArray.push(attr);
					}	
				}
			});			
			salesmanId = salesManIdArray.join(',');
			beatId = 'ALL';			
		} */
		
		if(salesmanId.length == 0) {
			$('#display-message').text("No Salesperson's are selected").removeClass('txt-black');
			return false;
		}
		
		
			var jsobObj = {};
			
			if(beatId == 'ALL') {
				jsobObj.fromDate = fromDate,
				jsobObj.toDate = toDate;
				jsobObj.salesManId = salesmanId;
				jsobObj.beatId = -1;
			}
			else {
				jsobObj.fromDate = fromDate,
				jsobObj.toDate = toDate;
				jsobObj.salesManId = salesmanId;
				jsobObj.beatId = Number(beatId);
			}
			
			jsobObj.beatId= '-1';
			
	/* 		jsobObj.beatId= '';
			$('#qExport-salesmanTable tbody tr').each(function() {
				var beatId = $(this).attr('qe-beat-id');
				if(typeof beatId !== "undefined")
				{ 
					beatId = ''+beatId;
					if(beatId.length > 0) {
					if(jsobObj.beatId.length == 0) {
						jsobObj.beatId = $(this).attr('qe-beat-id');
					} else {
						jsobObj.beatId = jsobObj.beatId + ',' +$(this).attr('qe-beat-id');
					}
					}
				}
				
			}); */
			$.ajax({
				beforeSend: function(xhr) {
					if(allowMultiLogin())
	   						setAjaxHeaderCommon(xhr);	
     		    	qExport_closeSalesmanList();
     		    	$(':focus').blur();
     		    	$('#display-message').text('Exporting....').addClass("txt-black");
     		    	qExport_beforeExport();
     		    },
		        method: "POST",
		        url: "/rsunify/app/ikeaCommonUtilController/qocRepopulation",
		        //async: false,
		        success: function(data) {
		        	 $.ajax({
		     		    /* beforeSend: function() {
		     		    	qExport_closeSalesmanList();
		     		    	$(':focus').blur();
		     		    	qExport_beforeExport();
		     		    }, */
		     		    url: quantumExport.startExport,
		     			method: 'POST',
		     			cache: false,
		     			dataType: 'text',
		     			data: {
		     				'exportData' : JSON.stringify(jsobObj)
		     			},
		     			beforeSend : function(xhr) {
				        	if(allowMultiLogin())
								setAjaxHeaderCommon(xhr);			
						},
		     			success: function(data) {
		     				var processId = data + '';
		     				if(processId.length > 0 && processId.indexOf("##") == -1) {
		     					quantumExport.exportStatusFlag = true;
		                 		qExport_startGetStatusMsg(processId);
		                 		$('#display-message').text('Exporting....').addClass("txt-black");
		     				}
		     				else {
		     					if(processId.length > 0 && processId.indexOf("##") > -1){
		     						var array = processId.split("##");
		     						processId = array[0];
		     						quantumExport.exportStatusFlag = true;
		     	            		/* Not needed keep displaying the error message.*/
		     						setTimeout(function() {
		     							$('#display-message').text(array[1]).removeClass("txt-black");
		     							//qExport_startGetStatusMsg(processId);
		     						}, 800);
		     					}
		     					qExport_afterExport();
		     					quantumExport.exportStatusFlag = false;
		     					if(quantumExport.exportStatusAjax){ 
		     						quantumExport.exportStatusAjax.abort();
		     					}
		     				}
		     			}, 
		     			error: function(e) {
		     				qExport_afterExport();
		     				quantumExport.exportStatusFlag = false;
		     				if(quantumExport.exportStatusAjax){ 
		     						quantumExport.exportStatusAjax.abort();
		     				}
		     			}
		     		});
		        },
		        error: function(e) { return false; }
		    });
			 
			 
			//return false;
			//getExportStatus
			/* $.ajax({
		    xhr: function() {
		        var xhr = new window.XMLHttpRequest();
		        xhr.upload.addEventListener("progress", function(evt) {
		            if (evt.lengthComputable) {
		            	quantumExport.exportStatusFlag = true;
		            	qExport_startGetStatusMsg();
		            }
		       }, false);
		
		       return xhr;
		    },
		    beforeSend: function() {
		    	$('#qExport-exportDataButton').attr('disabled', true).css('color', 'lightgray');
		    	qExport_closeSalesmanList();
		    },
		    url: quantumExport.startExport,
			method: 'POST',
			cache: false,
			data: {
				'exportData' : JSON.stringify(jsobObj)
			},
		//	dataType : 'application/json',
			success: function(data) {
				$('#qExport-exportDataButton').attr('disabled', false).css('color', 'black');
				if(data.exportFlag == "2") {
					$('#display-message').text(data.statusMessage);
				}
				quantumExport.exportStatusFlag = false;
				if(quantumExport.exportStatusAjax){ 
					quantumExport.exportStatusAjax.abort();
				}
			}, 
			error: function(e) {
				$('#qExport-exportDataButton').attr('disabled', false);
				quantumExport.exportStatusFlag = false;
				if(quantumExport.exportStatusAjax){ 
						quantumExport.exportStatusAjax.abort();
				}
			}
		});
			 */
			
		
	}
	
	function qExport_afterExport() {
		$('.pnl-footer input').attr('disabled', false).css('color', 'black');
		$('#qExport-closeButton').focus();
		hideLoadingImage();
	}
	
	function qExport_beforeExport() {
    	$(':focus').blur();
    	$('.pnl-footer input').attr('disabled', true).css('color', 'lightgray');
    	displayLoadingImage();
	}
	
	 function qExport_startGetStatusMsg(processId) {
	if(quantumExport.exportStatusFlag) {
		quantumExport.exportStatusAjax = $.ajax({
		    url: quantumExport.getExportStatus,
			method: 'POST',
			dataType: "JSON",
			data: {
				'processId' : processId
			},
			cache: false,
			beforeSend : function(xhr) {
	        	if(allowMultiLogin())
					setAjaxHeaderCommon(xhr);			
			},
			success: function(data) {
				if(data[0] == 0 && data[1] == 0 && data[2] == 1) {
					quantumExport.exportStatusFlag = false;
					$('#display-message').text("Export Completed...").addClass("txt-black");
					//$('#qExport-exportDataButton').attr('disabled', false).css('color', 'black');
					qExport_afterExport();
					//to Cntinuing the Export-sync process 
					generateNPCFiles(); 
				}
				else  {
					
					if(data[0] != 0) {
						$('#display-message').text(qExport_getMessage(data[0])).addClass("txt-black");;
					}
					else if(data[0] == 0 && (data[1] == 1 || data[2] == 0)) {
						$('#display-message').text("Waiting For Other Process To Finish").removeClass("txt-black");;
					}
					else {
						$('#display-message').text(qExport_getMessage(data[1])).addClass("txt-black");;
					}
					quantumExport.exportStatusFlag = true;
					setTimeout(function() {
						qExport_startGetStatusMsg(processId);
					}, (10000 + (Math.floor(Math.random() * 5) * 1000)));
				}
			}, 
			error: function(e) {
				//quantumExport.exportStatusFlag = false; --confirm with prasuna
				setTimeout(function() {
					qExport_startGetStatusMsg(processId);
				}, (10000 + (Math.floor(Math.random() * 5) * 1000)));
			}
		});
	}
} 
	
	 function qExport_getMessage(idx) {
		if(idx == '1') {
			return 'Exporting Data...';
		} else if(idx == '2') {
			return 'Exporting party related master table...';
		} else if(idx == '3') {
			return 'Exporting Child Party...';
		} else if(idx == '4' || idx == '5') {
			return 'Exporting basepack...';
		} else if(idx == '6') {
			return 'Exporting Invoice...';
		} else if(idx == '7') {
			return 'Exporting Consumer Coupon...';
		} else if(idx == '8') {
			return 'Exporting Damage Reason...';
		} else if(idx == '9') {
			return 'Exporting Template...';
		} else if(idx == '10') {
			return 'Exporting basepack Target...';
		} else if(idx == '11') {
			return 'Exporting QPS Target...';
		} else if(idx == '12') {
			return 'Exporting BTPR Scheme...';
		}else if(idx == '13') {
			return 'Exporting Scheme...';
		}else if(idx == '14' || idx == '15') {
			return 'Exporting QOC Details...';
		}else if(idx == '16') {
			return 'Exporting iQ Outlet Pack Details...';
		}else if(idx == '17') {
			return 'Exporting QOC Red Line Target Details...';
		}else if(idx == '18' || idx == '19') {
			return 'Exporting Outlet Parameters...';
		}else if(idx == '20') {
			return 'Exporting Vijeta Details...';
		}else if(idx == '21') {
			return 'Exporting Party Beat Type Details...';
		}else if(idx == '22') {
			return 'Exporting Pack Master...';
		}else if(idx == '23' || idx == '24' || idx == '25') {
			return 'Exporting IQ Incentive Scheme...';
		}else if(idx == '26') {
			return 'Exporting Outlet Basepack Masters...';
		}else if(idx == '27') {
			return 'Exporting UPL Target...';
		}else if(idx == '28') {
			return 'Exporting Perfect Store details...';
		}else if(idx == '29' || idx == '30') {
			return 'Exporting Perfect Day Details...';
		}else if(idx == '31') {
			return 'Export Quantum Telecalling Details...';
		}else if(idx == '32') {
			return 'Exporting Mass Merchandising Details...';
		}else if(idx == '33') {
			return 'Exporting OCF Details...';
		}else if(idx == '34' || idx == '35') {
			return 'Exporting Channel Product Listing...';
		}else if(idx == '36') {
			return 'Exporting QTM Image File Data...';
		}else {
			return idx;
		}
	 }

	//Close Multiusers Validations
	 function validateImportDataCloseMultiUsers(){
	 	var rsWindow;
	 	var targetURL = "/rsunify/app/systemImportData/validateImportDataMultiusers";
	     $.ajax({
	 		type: 'GET',
	 		url: targetURL,
	 		contentType: "text",
	 		data: {"loggedStatus": 2, "screenName" : "Beat Export"},
	 		cache: false,
	 		beforeSend : function(xhr) {
	        	if(allowMultiLogin())
					setAjaxHeaderCommon(xhr);			
			},
	 		success: function(data) {
	 		},
	 		error: function (e) {
	 			return false;			
	 		}
	     });
	 }
	
	function qExport_getSalesmanBeatLinkage() {
			$.ajax({
				method: 'POST',
				url: quantumExport.getSalemanBeatLinkage,
				async: false,
				cache: false,
				beforeSend : function(xhr) {
		        	if(allowMultiLogin())
						setAjaxHeaderCommon(xhr);			
				},
				success: function(data) {
					
					$(':focus').blur();
					
					var withoutDisplayText = data.replace('id="display-message"', "").replace('class="txt-sms-display"', "");
									
					$("#qe-salesmanBeatLink").hide();
					//data = data + ' <script> function closeAndClearSmBeatLink() { $("#qe-salesmanBeatLink").empty(); $("#qe-salesmanBeatLink").hide(); } ';
					$("#qe-salesmanBeatLink").html(withoutDisplayText);

					  $('<script>')
					    .attr('type', 'text/javascript')
					    .text('function closeAndClearSmBeatLink() { $("#qe-salesmanBeatLink").empty(); $("#qe-salesmanBeatLink").hide(); $("#qe-from-date").focus();}')
					    .appendTo('#qe-salesmanBeatLink');
					  
					$('#qe-salesmanBeatLink #loadSalesmanBeatLink').removeClass('app-layout-wrapper').addClass('pop-wrapper');
					$("#qe-salesmanBeatLink").show();
					$("#divisionId").focus();
				},
				error: function(e) {
				}
			});
	}
	
	function callSfmIkeaIntegrationSync(scrn){ 
		$('#display-message').text("Exporting SFM LeverEDGE Integration....");
		$('#display-message').addClass("txt-black");
		$.ajax({
		method: 'POST',
		url: quantumExport.callSfmIkeaIntegrationSync,
		async: false,
		cache: false,
		beforeSend : function(xhr) {
        	if(allowMultiLogin())
				setAjaxHeaderCommon(xhr);			
		},
		success: function(data) {
			$('#display-message').text("");
				return false;
			},
			error: function (e) {
				$('#display-message').text("Exporting SFM LeverEDGE Integration Failed...");
				$('#display-message').removeClass("txt-black");
				return false;			
			}
	    });
		if (scrn == 0){
			callcheckEmpStatus();
		}
	}
	
	function callcheckEmpStatus(){ 
		$('#display-message').text("");
		$('#display-message').addClass("txt-black");
		$.ajax({
		method: 'POST',
		url: quantumExport.callcheckEmpStatus,
		async: false,
		cache: false,
		beforeSend : function(xhr) {
        	if(allowMultiLogin())
				setAjaxHeaderCommon(xhr);			
		},
		success: function(data) {
				if($.trim(data).length > 0){
					dlgPM = $.messager.confirm({title: 'Warning', msg: $.trim(data),width: "700px",
						buttons:[{
				        text: 'Yes',
				        onClick: function(){
				        	qExport_salesmanData();
				        	dlgPM.dialog('destroy');
				        	return false;
				        }
				    },{
				        text: 'No',
				        onClick: function(){
				        	dlgPM.dialog('destroy');
				        	return false;
						}
				    }]
					});
				}else{
					qExport_salesmanData();
				}
				return false;
			},
			error: function (e) {
				$('#display-message').text("check Emp status process failed...");
				$('#display-message').removeClass("txt-black");
				return false;			
			}
	    });
	}
	//For Cntinuing Export Process after Beat Export  - start
	var processInProgress = false
	var sfmIkeaIntegrationEnableFlag = JSON.parse("true");
	function generateNPCFiles(){
		showDiaplyAlertMessages("Generating and exporting files please wait...", "info");
		setTimeout(function() {
			displayLoadingImage();
		}, 150);
		$('#divnewsPage').text("");
		processInProgress = true;
		if(sfmIkeaIntegrationEnableFlag) { // For SFM IKEA Integration Sync
			callSfmIkeaIntegrationSync(1);
		}
		instantOutletCreation(1); 
		$.ajax({
			url : '/rsunify/app/fileUploadId/upload',
			type : "POST",
			data : {},
			beforeSend : function(xhr) {
	        	if(allowMultiLogin())
					setAjaxHeaderCommon(xhr);			
			},
			success: function(data1){
				hideLoadingImage();
				processInProgress = false;
				var data = data1.split("$del");
				if(data[1]!=undefined){
					showMessageWindowAlertBox("UPI Payment Status", data[1], null,'600px',"info" );
				}
				switch(data[0]){
					case "SUCCESS":
						showDiaplyAlertMessages("Beat Export and Sync Completed successfully..", "info");
						break;
					case "NO_RECORDS":
						showDiaplyAlertMessages("There is no file to export. Please do Beat Export before proceeding with NPC export.", "error");
						break;
					case "FAILURE":
						showDiaplyAlertMessages("Failed to export files. Please try again!..", "error");
						break;
					case "7Z_PATH_WRONG":
						showDiaplyAlertMessages("Failed to zip files. Please check 7zip installation path!..", "error");
						break;
					case "ERR_UPLOAD":
						showDiaplyAlertMessages("Error in export. Please check network connectivity!..", "error");
						break;
					default:
						showDiaplyAlertMessages(data[0], "error");	
						break
				}
			}, error: function(jqXHR, textStatus){
				hideLoadingImage();
				showDiaplyAlertMessages(jqXHR.responseText, "error");
				processInProgress = false;
			}
		});
	}//For Cntinuing Export Process after Beat Export  - end 
	function downloadExportFailedExcel(){
		if(quantumExport.filepath != undefined && $.trim(quantumExport.filepath) != ""){
			downloadReportFileNewTab("/rsunify", quantumExport.filepath);
			$('#display-message').text("Report Generated Successfully.").addClass('txt-black');
		}else {
			$('#display-message').text("No Record found");
		}
	}
	
	function downloadExportFailedDetails(){
		var jsonObjfileInfi = [];	
		var jsonObjforheaders = [];
		var jsonObjWhereClause = {
			":val1": $('#qe-from-date').val(),
			":val2": $('#qe-to-date').val(),
			":val3": 2,//Calling from -->0 - Quantum Import 1 - Login, 2 - Beat Export
			":querycount":2
			};
			jsonObjfileInfi.push({
		        'title': "Beat Export,Outlet to Beat,Beat to Salesperson",
		        'reportfilename': "Beat Export",
		        'viewpage': "report/beatmapUtilityBackUpReport",
		        'viewname': "BEAT_EXPORT_SAL_BEAT_EXED_CAP",
		        "querycount":2
		    });
			jsonObjforheaders.push({
				'1': "Beat Cap :",
				'2': "",
				'3': "Outlet Cap :",
				'4': "",
				'val1': quantumExport.beatCap,
				'val2': "",
				'val3':quantumExport.outletCap,
				'val4':"",
			});
		var params = {
					"jsonObjforheaders": JSON.stringify(jsonObjforheaders),
					"jsonObjfileInfi" : JSON.stringify(jsonObjfileInfi),
					"jsonObjWhereClause" : JSON.stringify(jsonObjWhereClause) //Where condition
			};

		$.ajax({
				method : "POST",
				url : docker_path+'/app/reportsController/generatereport',
				data : params,
				beforeSend : function(xhr) {
		        	if(allowMultiLogin())
						setAjaxHeaderCommon(xhr);			
				},
				success : function(data) {
					hideLoadingImage();
					 if(data != undefined && $.trim(data) != ""){
						 quantumExport.popupflag = true;
						 quantumExport.filepath = data;
						 qexport_salExclu_validation();
						// downloadReportFileNewTab("/rsunify", data);
		       				//$('#display-message').text("Report Generated Successfully.").addClass('txt-black');
							}
				        if(data == false)
				        {
				        	quantumExport.popupflag = false;
				        	qexport_salExclu_validation();
				        	//$('#display-message').text("No Record found");
				        }
				},
		          error: function () {
		          }
			});
	}
	/* function qExport_startGetStatusMsg() {
		
		
		if(quantumExport.exportStatusFlag) {
			quantumExport.exportStatusAjax = $.ajax({
			    xhr: function() {
			        var xhr = new window.XMLHttpRequest();
			        xhr.upload.addEventListener("progress", function(evt) {
			            if (evt.lengthComputable) {
			            	quantumExport.exportStatusFlag = true;
			            }
			       }, false);
			       return xhr;
			    },
			    url: quantumExport.getExportStatus,
				method: 'GET',
				cache: false,
			//	dataType : 'application/json',
				success: function(data) {
					if(data.exportFlag == '2') {
						quantumExport.exportStatusFlag = false;
						$('#display-message').text(data.statusMessage);
					}
					else if(data.exportFlag == '1') {
						quantumExport.exportStatusFlag = true;
						$('#display-message').text(data.statusMessage);
						setTimeout(function() {
							qExport_startGetStatusMsg();
						}, 2000);
					}
					else {
						quantumExport.exportStatusFlag = false;
					}
				}, 
				error: function(e) {
					quantumExport.exportStatusFlag = false;
				}
			});
		}
	} */


</script>
<script type="text/javascript" src="/rsunify/resources/js/common-ui.js?v=R26.1.0_20260129023001"></script>
<script type="text/javascript" src="/rsunify/resources/js/rsPopup.js?v=R26.1.0_20260129023001"></script>


<!-- Context Menu Start -->
<div class="vs-context-menu">
        <ul>
            <li><a onclick="qExport_getSalesmanScreen()">Beat Export and Sync<span>Ctrl+G</span></a></li>
            <!-- <li><a onclick="qExport_clear()">Clear <span>Ctrl+M</span></a></li> -->
            <li><a onclick="qExport_closeAndClear()">Close <span>Ctrl+O</span></a></li>
        </ul>
        <div class="v-seprator"></div>
</div>  

<div class="vs-context-menu1">
        <ul>
            <li><a onclick="qExport_start()">Ok <span>Ctrl+Q</span></a></li>
           <!--  <li><a onclick="qExport_filterSalesmanScreen()">Find <span>Ctrl+F</span></a></li> -->
            <li><a onclick="qExport_closeSalesmanList()">Cancel <span>Ctrl+C</span></a></li>
        </ul>
        <div class="v-seprator"></div>
</div> 
<!-- Context Menu ends -->


<!-- shortcut scripts -->
<script>
//shortcut  
$(function() {
	
    $('#qExport-container').on('keydown', function(e) {
    	var theEvent = e || window.event;
	 	var key = theEvent.keyCode || theEvent.which;
	 	
	 	if($('#qExport-slist').is(':visible')) {
		 	if(key == 9) {
		 		if($('#qExport-rssmSearch').is(":focus")) {
		 			$('#qe_checkAll').focus();
		 		} else {
		 			$('#qExport-rssmSearch').focus();
		 		}
		 		theEvent.preventDefault();
				theEvent.stopPropagation();
		 	} else if(key == 32 && $('#qe_checkAll').is(":focus")) { 
		 		$('#qe_checkAll').trigger('click');
		 		theEvent.preventDefault();
				theEvent.stopPropagation();
		 	 } else if(key == 27) {
		 		/* $('#qExport-slist').hide();
		 		$('#qExport-listofSalesman').focus();
				$('.pnl-footer input').css('visibility', 'visible'); */
				qExport_filterToListRssm();
		 		theEvent.preventDefault();
				theEvent.stopPropagation();
		 	 }
		 	else if(key == 40) {
		 		//debugger;
		 		//$('#qExport-slist-add div:eq(0)').prop('contenteditable', true);
		 		//$('#qExport-slist-add div:eq(0)').attr('class', 'se1');
		 		//$('#qExport-slist-add div').trigger("dblclick");
		 		//$('#qExport-slist-add div:eq(0)').focus();
		 		 //$('#qExport-slist-add div:eq(0)').attr('style','background-color:blue');
		 		return false;
		 	}
    	  
       } else if($('#qExport-salesmanContainer').is(':visible')) {
		 // Ctrl + F
		    if (key == 70 && theEvent.ctrlKey) {
		    	//qExport_filterSalesmanScreen();
		    	e.stopPropagation();
		    	e.stopImmediatePropagation();
		    	e.preventDefault();
		    	return false;
		    }
	// Ctrl + q
		    else if (key == 81 && theEvent.ctrlKey) {
		    		qExport_start();
			    	e.stopPropagation();
			    	e.stopImmediatePropagation();
			    	e.preventDefault();
			    	return false;
		    }
		    // Ctrl + C
		    else if(key == 67 && theEvent.ctrlKey) {
		    	qExport_closeSalesmanList();
		    	e.stopPropagation();
		    	e.stopImmediatePropagation();
		    	e.preventDefault();
		    	return false;
		    } else if(key == 27) {
		 		qExport_closeSalesmanList();
		 		$('#qe-from-date').focus();
		 		theEvent.preventDefault();
				theEvent.stopPropagation();
		 	 }
      } else if($('#qExport-dateContainer').is(':visible')) {
				 	 var currentFocus = $(':focus');
				 	 var charCode = theEvent.charCode;
				 	 
					// Ctrl + G
						    if (key == 71 && theEvent.ctrlKey) {
						    	qExport_getSalesmanScreen();
						    	return false;
						    }
					// Ctrl + O
						    else if (key == 79 && theEvent.ctrlKey) {
						    	qExport_closeAndClear();
						    	 e.stopPropagation();
						    	 e.stopImmediatePropagation();
						    	 e.preventDefault();
						    	return false;
						    }
						    // Ctrl + M
						    else if(key == 77 && theEvent.ctrlKey) {
						    	qExport_clear();
						    	return false;
						    }
						// esc 
						 else if(key == 27) {
							 qExport_closeAndClear();
							return false;
						}
					}
    });
    $( document ).ready(function(){
    	if (optimusSalBeatLinkMsg != "") {
    		dlgPM = $.messager.confirm({title: 'Warning', msg: optimusSalBeatLinkMsg,width: "560px",
    			onClose : function(){
    				dlgPM.dialog('destroy');
    	        	$( "#qe-from-date" ).focus();
    	        	return false;
				},
    			buttons:[{
    	        text: 'Ok',
    	        onClick: function(){
    	        	dlgPM.dialog('destroy');
    	        	$( "#qe-from-date" ).focus();
    	        	return false;
    	        }
    	    }]
    		});
    	}
    	
    	$( document ).on( "keydown", "#qe-from-date, #qe-to-date, #qExport-exportDataButton, #qExport-closeButton,#ExportList-Ok-Cancel", function(e){
    		if( e.keyCode == 9  ){
    			if( $( this ).is( "input[type=text]" ) ){
    				rsu_date_behave.focusOut( this, e );
    			}
	    		if( !dateValidErrorFlg ){
	    			if( $( this ).is( "#qe-from-date" ) ){
	    				$( "#qe-to-date" ).focus();
	    				e.preventDefault();
	    				return false;
	    			} else if( $( this ).is( "#qe-to-date" ) ){
	    				$( "#qExport-exportDataButton" ).focus();
	    				e.preventDefault();
	    				return false;
	    			} else if( $( this ).is( "#qExport-exportDataButton" ) ){
	    				$( "#qExport-closeButton" ).focus();
	    				e.preventDefault();
	    				return false;
	    			} else if( $( this ).is( "#qExport-closeButton" ) ){
	    				$( "#qe-from-date" ).focus();
	    				e.preventDefault();
	    				return false;
	    			}else if( $( this ).is( "#ExportList-Ok-Cancel" ) ){
	    				$( "#qExport-listofSalesman" ).focus();
	    				e.preventDefault();
	    				return false;
	    			}
	    		} else {
	    			$( "#display-message" ).text( "Select valid date" );
	    		}
    		}
    	}); 
    	
    	
    });
});
var optimusSalBeatLinkMsg = "" 
function setDateInFromAndToList(){
	var firstDay = moment().add(0, 'days').format('DD/MM/YYYY');
	var secondDay = moment().add(1, 'days').format('DD/MM/YYYY');
	var thirdDay = moment().add(2, 'days').format('DD/MM/YYYY');
	var fourthDay = moment().add(3, 'days').format('DD/MM/YYYY');
	var fifthDay = moment().add(4, 'days').format('DD/MM/YYYY');
	var sixthDay = moment().add(5, 'days').format('DD/MM/YYYY');
	var seventhDay = moment().add(6, 'days').format('DD/MM/YYYY');
	
	var listItems= "";
	listItems+= "<option value='" + firstDay + "'>" + firstDay + "</option>";
	listItems+= "<option value='" + secondDay + "'>" + secondDay + "</option>";
    $("#qe-from-date").html(listItems);
    $("#qe-from-date").val(firstDay);
    
    listItems= "";
    listItems+= "<option value='" + firstDay + "'>" + firstDay + "</option>";
	listItems+= "<option value='" + secondDay + "'>" + secondDay + "</option>";
	listItems+= "<option value='" + thirdDay + "'>" + thirdDay + "</option>";
	listItems+= "<option value='" + fourthDay + "'>" + fourthDay + "</option>";
	listItems+= "<option value='" + fifthDay + "'>" + fifthDay + "</option>";
	listItems+= "<option value='" + sixthDay + "'>" + sixthDay + "</option>";
	listItems+= "<option value='" + seventhDay + "'>" + seventhDay + "</option>";
    $("#qe-to-date").html(listItems);
    $("#qe-to-date").val(firstDay);
}

function firstLogic () {	
	/* if user selected Export From Date as 'current date' and Export To Date as 'fifth date' and click's 
	the Export Beat button, as per existing logic 'Exporting data for the following Salesman Screen' will be opened.
	 */
	var isExistLogic = false;
	var firstDay = moment().add(0, 'days').format('DD/MM/YYYY');
	var fifthDay = moment().add(4, 'days').format('DD/MM/YYYY');
	if ( $("#qe-from-date").val() == firstDay && $("#qe-to-date").val() == fifthDay ) {
		isExistLogic = true;
	} 
	return isExistLogic;
}
</script>

<div id="qe-salesmanBeatLink">

</div>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"errorBeacon":"bam.nr-data.net","licenseKey":"dcb54cd47d","agent":"","beacon":"bam.nr-data.net","applicationTime":46,"applicationID":"1554295036","transactionName":"bgRXYxZYChVZVkVeDVdOZkcWUAoBe1pfQxBWDVlSFhYVE1lbRUIPfBlFWBZNRE5\/cGUe","queueTime":0}</script></body>
</html>